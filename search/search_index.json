{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Documenta\u00e7\u00e3o Risco Socioambiental O portal de Risco Socioambiental \u00e9 uma plataforma robusta e aberta que visa facilitar o cruzamento de informa\u00e7\u00f5es que permitam identificar potenciais impactos ambientais e sociais ligados \u00e0 produ\u00e7\u00e3o agr\u00edcola no Brasil, permitindo \u00e0s institui\u00e7\u00f5es financeiras, empresas, governos e outras partes interessadas entender melhor e mitigar riscos associados \u00e0 produ\u00e7\u00e3o agropecu\u00e1ria. Essa \u00e9 uma documenta\u00e7\u00e3o para a plataforma Risco Socioambiental , desenvolvida pelo Laborat\u00f3rio de Processamento de Images e Geoprocessamento da Universidade Federal de Goi\u00e1s (LAPIG/UFG) em parceria com o WWF .","title":"HOME"},{"location":"#documentacao-risco-socioambiental","text":"O portal de Risco Socioambiental \u00e9 uma plataforma robusta e aberta que visa facilitar o cruzamento de informa\u00e7\u00f5es que permitam identificar potenciais impactos ambientais e sociais ligados \u00e0 produ\u00e7\u00e3o agr\u00edcola no Brasil, permitindo \u00e0s institui\u00e7\u00f5es financeiras, empresas, governos e outras partes interessadas entender melhor e mitigar riscos associados \u00e0 produ\u00e7\u00e3o agropecu\u00e1ria. Essa \u00e9 uma documenta\u00e7\u00e3o para a plataforma Risco Socioambiental , desenvolvida pelo Laborat\u00f3rio de Processamento de Images e Geoprocessamento da Universidade Federal de Goi\u00e1s (LAPIG/UFG) em parceria com o WWF .","title":"Documenta\u00e7\u00e3o Risco Socioambiental"},{"location":"01-guia_dados_geograficos/","text":"Dados Geogr\u00e1ficos A plataforma de Risco Socioambiental visa facilitar o cruzamento de informa\u00e7\u00f5es que permitam identificar potenciais impactos ambientais e sociais ligados \u00e0 produ\u00e7\u00e3o agr\u00edcola no Brasil, permitindo \u00e0s institui\u00e7\u00f5es financeiras, empresas, governos e outras partes interessadas entender melhor e mitigar os riscos associados \u00e0 produ\u00e7\u00e3o agropecu\u00e1ria. A sua abordagem baseia-se em apresentar um conjunto de indicadores em um mapa interativo de f\u00e1cil navega\u00e7\u00e3o, e relat\u00f3rios que trazem s\u00e9ries hist\u00f3ricas destes dados. Na plataforma, os usu\u00e1rios podem realizar buscas, visualizar os dados de seu interesse, recuperar os mesmos e gerar relat\u00f3rios. A unidade de refer\u00eancia s\u00e3o os munic\u00edpios, mas tamb\u00e9m \u00e9 poss\u00edvel fazer an\u00e1lises por estados, biomas e regi\u00f5es espec\u00edficas. Agricultura Dado Descri\u00e7\u00e3o Data Escala Fonte Baixar dado \u00c1rea Plantada de Algod\u00e3o \u00c1reas de planta\u00e7\u00e3o de algod\u00e3o em caro\u00e7o por munic\u00edpios do Brasil, por hectares, no per\u00edodo de 2000 a 2015, conforme dados censit\u00e1rios do IBGE. 2000-2015 1:250.000 IBGE Download \u00c1rea plantada de cana-de-a\u00e7\u00facar \u00c1reas de planta\u00e7\u00e3o de cana-de-a\u00e7\u00facar por munic\u00edpios do Brasil, por hectares, no per\u00edodo de 2000 a 2015, conforme dados censit\u00e1rios do IBGE. 2000-2015 1:250.000 IBGE Download \u00c1rea Plantada de Milho \u00c1reas de planta\u00e7\u00e3o de Milho em gr\u00e3o por munic\u00edpios do Brasil, por hectares, no per\u00edodo de 2000 a 2015, conforme dados censit\u00e1rios do IBGE. 2000-2015 1:250.000 IBGE Download \u00c1rea Plantada de Soja \u00c1reas de planta\u00e7\u00e3o de Soja em gr\u00e3o, por hectares, no per\u00edodo de 2000 a 2015, conforme dados censit\u00e1rios do IBGE. 2000-2015 1:250.000 IBGE Download \u00c1reas de queimadas Dados de queimadas ocorridos no Brasil, para o per\u00edodo de 2002 \u00e0 2015, produzidos a partir de imagens MODIS (MCD45A1). 2002-2015 1:250.000 LAPIG Download Armaz\u00e9ns N\u00famero de armaz\u00e9ns destinados a armazenamento e controle de produ\u00e7\u00e3o no Brasil. Gerado a partir da compila\u00e7\u00e3o de dados da Agrosat\u00e9lite e da CONAB \u2013 Companhia Nacional de Abastecimento, espacializados pelo LAPIG \u2013 Laborat\u00f3rio de Processamento de Imagens e Geoporcessamento. 2017 1:250.000 LAPIG Download Assentamentos Rurais Localiza\u00e7\u00e3o dos assentamentos rurais, produzido pelo Instituto Nacional de Coloniza\u00e7\u00e3o e Reforma Agr\u00e1ria (INCRA). 2015 1:250.000 INCRA Download Desmatamento Dados de desmatamentos ocorridos, produzidos a partir de compila\u00e7\u00e3o de dados do PRODES(Bioma Amaz\u00f4nia: 2005 - 2016), SIAD(Bioma Cerrado: 2003 - 2016) e SOS Mata Atl\u00e2ntica(Bioma Mata Atl\u00e2ntica: 2011 - 2016). 2003-2016 1:250.000 PRODES Download Desmatamento Acumulado Desmatamento acumulado nos \u00faltimos 5 anos (2012 a 2016), nos Biomas Amaz\u00f4nia, Cerrado e Mata atl\u00e2ntica. Utilizando dados do PRODES/INPE para a Amaz\u00f4nia, SIAD/LAPIG para o Cerrado, SOS Mata Atl\u00e2ntica para a Mata Atl\u00e2ntica. 2016 1:250.000 LAPIG Download Floresta plantada Dados produzido pela ONG Transparent World com o apoio do WRI, com abrang\u00eancia territorial para todo o Brasil. 2014 1:250.000 WRI Download Piv\u00f4s centrais Mapeamento realizado pela Embrapa da \u00e1rea irrigada e do n\u00famero de equipamentos de irriga\u00e7\u00e3o por piv\u00f4 central no Brasil em 2013. 2013 1:250.000 EMBRAPA Download Produ\u00e7\u00e3o de Algod\u00e3o - ton Quantidade de algod\u00e3o em caro\u00e7o produzido por munic\u00edpios do brasil, em Toneladas, no per\u00edodo de 2000 a 2015, conforme dados censit\u00e1rios do IBGE. 2000-2015 1:250.000 IBGE Download Produ\u00e7\u00e3o de cana-de-a\u00e7\u00facar - ton Quantidade de cana-de-a\u00e7\u00facar produzida por munic\u00edpios do brasil, em Toneladas, no per\u00edodo de 2000 a 2015, conforme dados censit\u00e1rios do IBGE. 2000-2015 1:250.000 IBGE Download Produ\u00e7\u00e3o de Lenha - m\u00b3 Quantidade de Lenha produzida por munic\u00edpios do brasil, em Metros C\u00fabicos, no per\u00edodo de 2000 a 2015, conforme dados censit\u00e1rios do IBGE. 2000-2015 1:250.000 IBGE Download Produ\u00e7\u00e3o de Milho - ton Quantidade de milho em gr\u00e3o produzido por munic\u00edpios do brasil, em Toneladas, no per\u00edodo de 2000 a 2015, conforme dados censit\u00e1rios do IBGE. 2000-2015 1:250.000 IBGE Download Produ\u00e7\u00e3o de Soja - ton Quantidade de soja em gr\u00e3o produzida por munic\u00edpios do brasil, em Toneladas, no per\u00edodo de 2000 a 2015, conforme dados censit\u00e1rios do IBGE. 2000-2015 1:250.000 IBGE Download Pecu\u00e1ria Dado Descri\u00e7\u00e3o Data Escala Fonte Baixar dado \u00c1reas de pastagens Mapeamento de \u00e1reas de pastagem, a partir de compila\u00e7\u00e3o de dados TerraClass Amazon; Funcate; PROBIO; Canasat e TNC. A \u00e1rea de pastagem mapeada \u00e9 de 175.396.874 ha, os mapeamentos que comp\u00f5em s\u00e3o: Bioma Pantanal - Mapeamento da Bacia do Alto Paraguai para 2014; Bioma Caatinga ( Mapeamento Lapig - Vers\u00e3o 2 2014-2016) - Esse mapeamento classificou as \u00e1reas de pasto limpo, pasto sujo e \u00e1rea degradada (solo exposto); Bioma Mata Atl\u00e2ntica (Mapeamento Lapig 2014-2016) - Esse mapeamento classificou as \u00e1reas de pasto limpo, pasto sujo e \u00e1rea degradada (solo exposto); Bioma Pampa - Mapeamento realizado pelo IBGE para o estado do Rio Grande do Sul (2012); Bioma Amaz\u00f4nia - Mapeamento TerraClass Amaz\u00f4nia 2014; Bioma Cerrado - Mapeamento TerraClass Cerrado 2013. 2016 1:250.000 LAPIG Download \u00c1reas de queimadas Dados de queimadas ocorridos no Brasil, para o per\u00edodo de 2002 \u00e0 2016, produzidos a partir de imagens MODIS (MCD45A1). 2002-2016 1:250.000 LAPIG Download Desmatamento Dados de desmatamentos ocorridos, produzidos a partir de compila\u00e7\u00e3o de dados do PRODES(Bioma Amaz\u00f4nia: 2005 - 2016), SIAD(Bioma Cerrado: 2003 - 2016) e SOS Mata Atl\u00e2ntica(Bioma Mata Atl\u00e2ntica: 2011 - 2016). 2003-2016 1:250.000 PRODES Download Desmatamento Acumulado Desmatamento acumulado nos \u00faltimos 5 anos (2012 a 2016), nos Biomas Amaz\u00f4nia, Cerrado e Mata atl\u00e2ntica. Utilizando dados do PRODES/INPE para a Amaz\u00f4nia, SIAD/LAPIG para o Cerrado, SOS Mata Atl\u00e2ntica para a Mata Atl\u00e2ntica. 2016 1:250.000 LAPIG Download Frigor\u00edficos e matadouros Dado produzido a partir de informa\u00e7\u00f5es de Matadouros e/ou Frigor\u00edficos Bovinos do Brasil aptos a exporta\u00e7\u00e3o, inspecionados visualmente pelo LAPIG. 2017 1:250.000 LAPIG Download Produ\u00e7\u00e3o de leite - lt Quantidade de leite em litros produzido por munic\u00edpios do brasil, no per\u00edodo de 2000 a 2015, conforme dados censit\u00e1rios do IBGE. 2000-2015 1:250.000 IBGE Download Rebanho bovino Quantidade de bovinos nos munic\u00edpios brasileiros. Informa\u00e7\u00e3o produzida pelo Instituto Brasileiro de Geografia e Estat\u00edstica (IBGE) e espacializada pelo LAPIG. 2000-2015 1:250.000 IBGE Download Social Dado Descri\u00e7\u00e3o Data Escala Fonte Baixar dado \u00c1reas de terras ind\u00edgenas \u00c1reas de terras ind\u00edgenas brasileiras incluindo situa\u00e7\u00e3o (regularizada, delimitada, etc), produzidos pela Funda\u00e7\u00e3o Nacional do \u00cdndio (FUNAI). 2012 1:250.000 FUNAI Download \u00c1reas Embargadas \u00c1reas que sofrer\u00e3o san\u00e7\u00f5es administrativas e/ou medidas cautelar, tendo por objetivo propiciar a regenera\u00e7\u00e3o do meio ambiente e dar viabilidade \u00e0 recupera\u00e7\u00e3o da \u00e1rea degradada, fonte IBAMA. 2017 1:250.000 LAPIG Download Conflitos por \u00e1gua (n\u00b0 ocorr\u00eancias) N\u00famero de ocorr\u00eancias de a\u00e7\u00f5es de resist\u00eancia por munic\u00edpio, em geral coletivas, que visam garantir o uso e a preserva\u00e7\u00e3o das \u00e1guas, no per\u00edodo de 2006 \u00e1 2015, produzidos pela CPT - Comiss\u00e3o Pastoral da Terra - espacializados pelo Lapig. 2006-2015 1:250.000 CPT Download Conflitos por terra (n\u00b0 ocorr\u00eancias) N\u00famero de conflitos por munic\u00edpio em a\u00e7\u00f5es de resist\u00eancia e enfrentamento pela posse, uso e propriedade da terra e pelo acesso aos recursos naturais, no per\u00edodo de 2010 \u00e1 2015, produzidos pela CPT - Comiss\u00e3o Pastoral da Terra - espacializados pelo Lapig. 2010-2015 1:250.000 CPT Download Conflitos por terra (n\u00b0 pessoas) N\u00famero de pessoas envolvidas em conflitos ocorridos por munic\u00edpio, em a\u00e7\u00f5es de resist\u00eancia e enfrentamento pela posse, uso e propriedade da terra e pelo acesso aos recursos naturais, no per\u00edodo de 2010 \u00e1 2015, produzidos pela CPT - Comiss\u00e3o Pastoral da Terra - espacializados pelo Lapig. 2010-2015 1:250.000 CPT Download \u00cdndice de Desenvolvimento Humano \u00cdndice de Desenvolvimento Humano Municipal, calculado pela m\u00e9dia geom\u00e9trica dos \u00edndices das dimens\u00f5es de Renda, Educa\u00e7\u00e3o e Longevidade. Esse c\u00e1lculo foi realizado a partir das informa\u00e7\u00f5es dos 3 \u00faltimos Censos Demogr\u00e1ficos do IBGE \u2013 1991, 2000 e 2010 e espacializado pelo LAPIG. 1991/ 2000/ 2010 1:250.000 IBGE Download Quilombos \u00c1reas de Quilombos que possuem titula\u00e7\u00e3o de territ\u00f3rios quilombolas, produzido pelo Instituto Nacional de Coloniza\u00e7\u00e3o e Reforma Agr\u00e1ria (INCRA). 2015 1:250.000 INCRA Download Terras ind\u00edgenas Quantidade de terras ind\u00edgenas por munic\u00edpio do Brasil at\u00e9 o ano de 2015, segundo dados produzidos pela Funda\u00e7\u00e3o Nacional do \u00cdndio(FUNAI) e espacializados pelo LAPIG. 2015 1:250.000 FUNAI Download Trabalho Escravo N\u00famero de pessoas envolvidas por munic\u00edpio, em a\u00e7\u00f5es de trabalhos for\u00e7ados, jornada exaustiva ou por sujeit\u00e1-lo \u00e1 condi\u00e7\u00f5es degradantes de trabalho, no per\u00edodo de 2000/2002 e de 2008 a 2016, produzidos pela Comiss\u00e3o Pastoral da Terra (CPT) e espacializados pelo LAPIG. 2000-2016 1:250.000 CPT Download Ambiental Dado Descri\u00e7\u00e3o Data Escala Fonte Baixar dado \u00c1reas priorit\u00e1rias para conserva\u00e7\u00e3o da biodiversidade Revis\u00e3o de \u00e1reas priorit\u00e1rias para a conserva\u00e7\u00e3o da biodiversidade, classificadas quanto a import\u00e2ncia biol\u00f3gica. Produzido pelo Minit\u00e9rio do Meio Ambiente (MMA) 2007 1:250.000 MMA Download Cobertura vegetal remanescente Compila\u00e7\u00e3o de mapeamentos de vegeta\u00e7\u00e3o nativa organizado pelo LAPIG/UFG.Para o bioma Amaz\u00f4nia considerou-se os dados do TerraClass Amaz\u00f4nia, com refer\u00eancia em 2012. Para o bioma Cerrado utilizou-se os dados TerraClass Cerrado, com refer\u00eancia em 2012. Os dados produzidos pela SOS Mata Atl\u00e2ntica, com refer\u00eancia em 2014, foram utilizados no bioma Mata Atl\u00e2ntica. O Mapeamento da cobertura vegetal da Bacia do Alto Paraguai, com refer\u00eancia em 2014, foi utilizado para o bioma Pantanal. Nos biomas Caatinga e Pampa considerou-se os dados produzidos no \u00e2mbito do PMDBBS, com refer\u00eancia em 2008 2014 1:250.000 LAPIG Download Corpos d'\u00e1gua Mapeamento dos corpos de \u00e1gua dos biomas: Caatinga (2008/2009), Mata Atl\u00e2ntica (2008/2009), Cerrado (2008/2009/2010), Pampa (2008/2009) e Pantanal (2008/2009) com base no Projeto de Monitoramento do Desmatamento dos Biomas Brasileiros por Sat\u00e9lite (PMDBBS). 2009 1:250.000 PMDBBS Download D\u00e9ficit de APP Dado produzido pelo CSR/UFMG e LAGESA/UFMG com o apoio da Climate and Land Use Alliance, com abrang\u00eancia territorial para todo Brasil. 2014 1:250.000 CSR/UFMG Download D\u00e9ficit de Reserva Legal Dado produzido pelo CSR/UFMG e LAGESA/UFMG com o apoio da Climate and Land Use Alliance, com abrang\u00eancia territorial para todo Brasil. 2014 1:250.000 CSR/UFMG Download D\u00e9ficit h\u00eddrico Dados acumulados do ano de 2012 do m\u00e1ximo de \u00e1gua doce dispon\u00edvel para infiltra\u00e7\u00e3o e escoamento (Blue Water) para as ottobacias de n\u00edvel 6 localizadas no Brasil, produzidos a partir de imagens do produto MOD16A2 e sat\u00e9lite TRMM. 2012 1:250.000 LAPIG Download Unidades de Conserva\u00e7\u00e3o de Prote\u00e7\u00e3o Integral Localiza\u00e7\u00e3o das unidades de conserva\u00e7\u00e3o de prote\u00e7\u00e3o integral brasileiras, incluindo a Base ao Milion\u00e9simo do IBGE de 2014. 2014 1:250.000 IBGE Download Econ\u00f4mico Dado Descri\u00e7\u00e3o Data Escala Fonte Baixar dado Centrais hidrel\u00e9tricas Localiza\u00e7\u00e3o de pequenas centrais hidrel\u00e9tricas, dado produzido pela Ag\u00eancia Nacional de Energia El\u00e9trica (ANEEL). 2017 1:250.000 ANEEL Download","title":"Dados Geogr\u00e1ficos"},{"location":"01-guia_dados_geograficos/#dados-geograficos","text":"A plataforma de Risco Socioambiental visa facilitar o cruzamento de informa\u00e7\u00f5es que permitam identificar potenciais impactos ambientais e sociais ligados \u00e0 produ\u00e7\u00e3o agr\u00edcola no Brasil, permitindo \u00e0s institui\u00e7\u00f5es financeiras, empresas, governos e outras partes interessadas entender melhor e mitigar os riscos associados \u00e0 produ\u00e7\u00e3o agropecu\u00e1ria. A sua abordagem baseia-se em apresentar um conjunto de indicadores em um mapa interativo de f\u00e1cil navega\u00e7\u00e3o, e relat\u00f3rios que trazem s\u00e9ries hist\u00f3ricas destes dados. Na plataforma, os usu\u00e1rios podem realizar buscas, visualizar os dados de seu interesse, recuperar os mesmos e gerar relat\u00f3rios. A unidade de refer\u00eancia s\u00e3o os munic\u00edpios, mas tamb\u00e9m \u00e9 poss\u00edvel fazer an\u00e1lises por estados, biomas e regi\u00f5es espec\u00edficas.","title":"Dados Geogr\u00e1ficos"},{"location":"01-guia_dados_geograficos/#agricultura","text":"Dado Descri\u00e7\u00e3o Data Escala Fonte Baixar dado \u00c1rea Plantada de Algod\u00e3o \u00c1reas de planta\u00e7\u00e3o de algod\u00e3o em caro\u00e7o por munic\u00edpios do Brasil, por hectares, no per\u00edodo de 2000 a 2015, conforme dados censit\u00e1rios do IBGE. 2000-2015 1:250.000 IBGE Download \u00c1rea plantada de cana-de-a\u00e7\u00facar \u00c1reas de planta\u00e7\u00e3o de cana-de-a\u00e7\u00facar por munic\u00edpios do Brasil, por hectares, no per\u00edodo de 2000 a 2015, conforme dados censit\u00e1rios do IBGE. 2000-2015 1:250.000 IBGE Download \u00c1rea Plantada de Milho \u00c1reas de planta\u00e7\u00e3o de Milho em gr\u00e3o por munic\u00edpios do Brasil, por hectares, no per\u00edodo de 2000 a 2015, conforme dados censit\u00e1rios do IBGE. 2000-2015 1:250.000 IBGE Download \u00c1rea Plantada de Soja \u00c1reas de planta\u00e7\u00e3o de Soja em gr\u00e3o, por hectares, no per\u00edodo de 2000 a 2015, conforme dados censit\u00e1rios do IBGE. 2000-2015 1:250.000 IBGE Download \u00c1reas de queimadas Dados de queimadas ocorridos no Brasil, para o per\u00edodo de 2002 \u00e0 2015, produzidos a partir de imagens MODIS (MCD45A1). 2002-2015 1:250.000 LAPIG Download Armaz\u00e9ns N\u00famero de armaz\u00e9ns destinados a armazenamento e controle de produ\u00e7\u00e3o no Brasil. Gerado a partir da compila\u00e7\u00e3o de dados da Agrosat\u00e9lite e da CONAB \u2013 Companhia Nacional de Abastecimento, espacializados pelo LAPIG \u2013 Laborat\u00f3rio de Processamento de Imagens e Geoporcessamento. 2017 1:250.000 LAPIG Download Assentamentos Rurais Localiza\u00e7\u00e3o dos assentamentos rurais, produzido pelo Instituto Nacional de Coloniza\u00e7\u00e3o e Reforma Agr\u00e1ria (INCRA). 2015 1:250.000 INCRA Download Desmatamento Dados de desmatamentos ocorridos, produzidos a partir de compila\u00e7\u00e3o de dados do PRODES(Bioma Amaz\u00f4nia: 2005 - 2016), SIAD(Bioma Cerrado: 2003 - 2016) e SOS Mata Atl\u00e2ntica(Bioma Mata Atl\u00e2ntica: 2011 - 2016). 2003-2016 1:250.000 PRODES Download Desmatamento Acumulado Desmatamento acumulado nos \u00faltimos 5 anos (2012 a 2016), nos Biomas Amaz\u00f4nia, Cerrado e Mata atl\u00e2ntica. Utilizando dados do PRODES/INPE para a Amaz\u00f4nia, SIAD/LAPIG para o Cerrado, SOS Mata Atl\u00e2ntica para a Mata Atl\u00e2ntica. 2016 1:250.000 LAPIG Download Floresta plantada Dados produzido pela ONG Transparent World com o apoio do WRI, com abrang\u00eancia territorial para todo o Brasil. 2014 1:250.000 WRI Download Piv\u00f4s centrais Mapeamento realizado pela Embrapa da \u00e1rea irrigada e do n\u00famero de equipamentos de irriga\u00e7\u00e3o por piv\u00f4 central no Brasil em 2013. 2013 1:250.000 EMBRAPA Download Produ\u00e7\u00e3o de Algod\u00e3o - ton Quantidade de algod\u00e3o em caro\u00e7o produzido por munic\u00edpios do brasil, em Toneladas, no per\u00edodo de 2000 a 2015, conforme dados censit\u00e1rios do IBGE. 2000-2015 1:250.000 IBGE Download Produ\u00e7\u00e3o de cana-de-a\u00e7\u00facar - ton Quantidade de cana-de-a\u00e7\u00facar produzida por munic\u00edpios do brasil, em Toneladas, no per\u00edodo de 2000 a 2015, conforme dados censit\u00e1rios do IBGE. 2000-2015 1:250.000 IBGE Download Produ\u00e7\u00e3o de Lenha - m\u00b3 Quantidade de Lenha produzida por munic\u00edpios do brasil, em Metros C\u00fabicos, no per\u00edodo de 2000 a 2015, conforme dados censit\u00e1rios do IBGE. 2000-2015 1:250.000 IBGE Download Produ\u00e7\u00e3o de Milho - ton Quantidade de milho em gr\u00e3o produzido por munic\u00edpios do brasil, em Toneladas, no per\u00edodo de 2000 a 2015, conforme dados censit\u00e1rios do IBGE. 2000-2015 1:250.000 IBGE Download Produ\u00e7\u00e3o de Soja - ton Quantidade de soja em gr\u00e3o produzida por munic\u00edpios do brasil, em Toneladas, no per\u00edodo de 2000 a 2015, conforme dados censit\u00e1rios do IBGE. 2000-2015 1:250.000 IBGE Download","title":"Agricultura"},{"location":"01-guia_dados_geograficos/#pecuaria","text":"Dado Descri\u00e7\u00e3o Data Escala Fonte Baixar dado \u00c1reas de pastagens Mapeamento de \u00e1reas de pastagem, a partir de compila\u00e7\u00e3o de dados TerraClass Amazon; Funcate; PROBIO; Canasat e TNC. A \u00e1rea de pastagem mapeada \u00e9 de 175.396.874 ha, os mapeamentos que comp\u00f5em s\u00e3o: Bioma Pantanal - Mapeamento da Bacia do Alto Paraguai para 2014; Bioma Caatinga ( Mapeamento Lapig - Vers\u00e3o 2 2014-2016) - Esse mapeamento classificou as \u00e1reas de pasto limpo, pasto sujo e \u00e1rea degradada (solo exposto); Bioma Mata Atl\u00e2ntica (Mapeamento Lapig 2014-2016) - Esse mapeamento classificou as \u00e1reas de pasto limpo, pasto sujo e \u00e1rea degradada (solo exposto); Bioma Pampa - Mapeamento realizado pelo IBGE para o estado do Rio Grande do Sul (2012); Bioma Amaz\u00f4nia - Mapeamento TerraClass Amaz\u00f4nia 2014; Bioma Cerrado - Mapeamento TerraClass Cerrado 2013. 2016 1:250.000 LAPIG Download \u00c1reas de queimadas Dados de queimadas ocorridos no Brasil, para o per\u00edodo de 2002 \u00e0 2016, produzidos a partir de imagens MODIS (MCD45A1). 2002-2016 1:250.000 LAPIG Download Desmatamento Dados de desmatamentos ocorridos, produzidos a partir de compila\u00e7\u00e3o de dados do PRODES(Bioma Amaz\u00f4nia: 2005 - 2016), SIAD(Bioma Cerrado: 2003 - 2016) e SOS Mata Atl\u00e2ntica(Bioma Mata Atl\u00e2ntica: 2011 - 2016). 2003-2016 1:250.000 PRODES Download Desmatamento Acumulado Desmatamento acumulado nos \u00faltimos 5 anos (2012 a 2016), nos Biomas Amaz\u00f4nia, Cerrado e Mata atl\u00e2ntica. Utilizando dados do PRODES/INPE para a Amaz\u00f4nia, SIAD/LAPIG para o Cerrado, SOS Mata Atl\u00e2ntica para a Mata Atl\u00e2ntica. 2016 1:250.000 LAPIG Download Frigor\u00edficos e matadouros Dado produzido a partir de informa\u00e7\u00f5es de Matadouros e/ou Frigor\u00edficos Bovinos do Brasil aptos a exporta\u00e7\u00e3o, inspecionados visualmente pelo LAPIG. 2017 1:250.000 LAPIG Download Produ\u00e7\u00e3o de leite - lt Quantidade de leite em litros produzido por munic\u00edpios do brasil, no per\u00edodo de 2000 a 2015, conforme dados censit\u00e1rios do IBGE. 2000-2015 1:250.000 IBGE Download Rebanho bovino Quantidade de bovinos nos munic\u00edpios brasileiros. Informa\u00e7\u00e3o produzida pelo Instituto Brasileiro de Geografia e Estat\u00edstica (IBGE) e espacializada pelo LAPIG. 2000-2015 1:250.000 IBGE Download","title":"Pecu\u00e1ria"},{"location":"01-guia_dados_geograficos/#social","text":"Dado Descri\u00e7\u00e3o Data Escala Fonte Baixar dado \u00c1reas de terras ind\u00edgenas \u00c1reas de terras ind\u00edgenas brasileiras incluindo situa\u00e7\u00e3o (regularizada, delimitada, etc), produzidos pela Funda\u00e7\u00e3o Nacional do \u00cdndio (FUNAI). 2012 1:250.000 FUNAI Download \u00c1reas Embargadas \u00c1reas que sofrer\u00e3o san\u00e7\u00f5es administrativas e/ou medidas cautelar, tendo por objetivo propiciar a regenera\u00e7\u00e3o do meio ambiente e dar viabilidade \u00e0 recupera\u00e7\u00e3o da \u00e1rea degradada, fonte IBAMA. 2017 1:250.000 LAPIG Download Conflitos por \u00e1gua (n\u00b0 ocorr\u00eancias) N\u00famero de ocorr\u00eancias de a\u00e7\u00f5es de resist\u00eancia por munic\u00edpio, em geral coletivas, que visam garantir o uso e a preserva\u00e7\u00e3o das \u00e1guas, no per\u00edodo de 2006 \u00e1 2015, produzidos pela CPT - Comiss\u00e3o Pastoral da Terra - espacializados pelo Lapig. 2006-2015 1:250.000 CPT Download Conflitos por terra (n\u00b0 ocorr\u00eancias) N\u00famero de conflitos por munic\u00edpio em a\u00e7\u00f5es de resist\u00eancia e enfrentamento pela posse, uso e propriedade da terra e pelo acesso aos recursos naturais, no per\u00edodo de 2010 \u00e1 2015, produzidos pela CPT - Comiss\u00e3o Pastoral da Terra - espacializados pelo Lapig. 2010-2015 1:250.000 CPT Download Conflitos por terra (n\u00b0 pessoas) N\u00famero de pessoas envolvidas em conflitos ocorridos por munic\u00edpio, em a\u00e7\u00f5es de resist\u00eancia e enfrentamento pela posse, uso e propriedade da terra e pelo acesso aos recursos naturais, no per\u00edodo de 2010 \u00e1 2015, produzidos pela CPT - Comiss\u00e3o Pastoral da Terra - espacializados pelo Lapig. 2010-2015 1:250.000 CPT Download \u00cdndice de Desenvolvimento Humano \u00cdndice de Desenvolvimento Humano Municipal, calculado pela m\u00e9dia geom\u00e9trica dos \u00edndices das dimens\u00f5es de Renda, Educa\u00e7\u00e3o e Longevidade. Esse c\u00e1lculo foi realizado a partir das informa\u00e7\u00f5es dos 3 \u00faltimos Censos Demogr\u00e1ficos do IBGE \u2013 1991, 2000 e 2010 e espacializado pelo LAPIG. 1991/ 2000/ 2010 1:250.000 IBGE Download Quilombos \u00c1reas de Quilombos que possuem titula\u00e7\u00e3o de territ\u00f3rios quilombolas, produzido pelo Instituto Nacional de Coloniza\u00e7\u00e3o e Reforma Agr\u00e1ria (INCRA). 2015 1:250.000 INCRA Download Terras ind\u00edgenas Quantidade de terras ind\u00edgenas por munic\u00edpio do Brasil at\u00e9 o ano de 2015, segundo dados produzidos pela Funda\u00e7\u00e3o Nacional do \u00cdndio(FUNAI) e espacializados pelo LAPIG. 2015 1:250.000 FUNAI Download Trabalho Escravo N\u00famero de pessoas envolvidas por munic\u00edpio, em a\u00e7\u00f5es de trabalhos for\u00e7ados, jornada exaustiva ou por sujeit\u00e1-lo \u00e1 condi\u00e7\u00f5es degradantes de trabalho, no per\u00edodo de 2000/2002 e de 2008 a 2016, produzidos pela Comiss\u00e3o Pastoral da Terra (CPT) e espacializados pelo LAPIG. 2000-2016 1:250.000 CPT Download","title":"Social"},{"location":"01-guia_dados_geograficos/#ambiental","text":"Dado Descri\u00e7\u00e3o Data Escala Fonte Baixar dado \u00c1reas priorit\u00e1rias para conserva\u00e7\u00e3o da biodiversidade Revis\u00e3o de \u00e1reas priorit\u00e1rias para a conserva\u00e7\u00e3o da biodiversidade, classificadas quanto a import\u00e2ncia biol\u00f3gica. Produzido pelo Minit\u00e9rio do Meio Ambiente (MMA) 2007 1:250.000 MMA Download Cobertura vegetal remanescente Compila\u00e7\u00e3o de mapeamentos de vegeta\u00e7\u00e3o nativa organizado pelo LAPIG/UFG.Para o bioma Amaz\u00f4nia considerou-se os dados do TerraClass Amaz\u00f4nia, com refer\u00eancia em 2012. Para o bioma Cerrado utilizou-se os dados TerraClass Cerrado, com refer\u00eancia em 2012. Os dados produzidos pela SOS Mata Atl\u00e2ntica, com refer\u00eancia em 2014, foram utilizados no bioma Mata Atl\u00e2ntica. O Mapeamento da cobertura vegetal da Bacia do Alto Paraguai, com refer\u00eancia em 2014, foi utilizado para o bioma Pantanal. Nos biomas Caatinga e Pampa considerou-se os dados produzidos no \u00e2mbito do PMDBBS, com refer\u00eancia em 2008 2014 1:250.000 LAPIG Download Corpos d'\u00e1gua Mapeamento dos corpos de \u00e1gua dos biomas: Caatinga (2008/2009), Mata Atl\u00e2ntica (2008/2009), Cerrado (2008/2009/2010), Pampa (2008/2009) e Pantanal (2008/2009) com base no Projeto de Monitoramento do Desmatamento dos Biomas Brasileiros por Sat\u00e9lite (PMDBBS). 2009 1:250.000 PMDBBS Download D\u00e9ficit de APP Dado produzido pelo CSR/UFMG e LAGESA/UFMG com o apoio da Climate and Land Use Alliance, com abrang\u00eancia territorial para todo Brasil. 2014 1:250.000 CSR/UFMG Download D\u00e9ficit de Reserva Legal Dado produzido pelo CSR/UFMG e LAGESA/UFMG com o apoio da Climate and Land Use Alliance, com abrang\u00eancia territorial para todo Brasil. 2014 1:250.000 CSR/UFMG Download D\u00e9ficit h\u00eddrico Dados acumulados do ano de 2012 do m\u00e1ximo de \u00e1gua doce dispon\u00edvel para infiltra\u00e7\u00e3o e escoamento (Blue Water) para as ottobacias de n\u00edvel 6 localizadas no Brasil, produzidos a partir de imagens do produto MOD16A2 e sat\u00e9lite TRMM. 2012 1:250.000 LAPIG Download Unidades de Conserva\u00e7\u00e3o de Prote\u00e7\u00e3o Integral Localiza\u00e7\u00e3o das unidades de conserva\u00e7\u00e3o de prote\u00e7\u00e3o integral brasileiras, incluindo a Base ao Milion\u00e9simo do IBGE de 2014. 2014 1:250.000 IBGE Download","title":"Ambiental"},{"location":"01-guia_dados_geograficos/#economico","text":"Dado Descri\u00e7\u00e3o Data Escala Fonte Baixar dado Centrais hidrel\u00e9tricas Localiza\u00e7\u00e3o de pequenas centrais hidrel\u00e9tricas, dado produzido pela Ag\u00eancia Nacional de Energia El\u00e9trica (ANEEL). 2017 1:250.000 ANEEL Download","title":"Econ\u00f4mico"},{"location":"01-guia_funcionalidades/","text":"Funcionalidades A abordagem da plataforma baseia-se em apresentar um vasto conjunto de dados secund\u00e1rios relevantes (fontes oficiais e dados de refer\u00eancia) em um mapa interativo de f\u00e1cil navega\u00e7\u00e3o. Todos os indicadores s\u00e3o listados j\u00e1 com seus respectivos valores, logo na p\u00e1gina inicial da plataforma, promovendo assim o acesso mais r\u00e1pido a informa\u00e7\u00e3o. Dashboard O dashboard da Plataforma Risco Socioambiental \u00e9 formado por quatro elementos principais: 1 - Indicadores A unidade de refer\u00eancia s\u00e3o os munic\u00edpios, mas tamb\u00e9m \u00e9 poss\u00edvel fazer an\u00e1lises considerando todo o territ\u00f3rio nacional, estados, biomas e regi\u00f5es espec\u00edficas de interesse (como o Matopiba e Arco do Desmatamento). Os indicadores tamb\u00e9m podem ser agrupados por categorias (Agricultura, Ambiental Econ\u00f4mico, Natural, Pecu\u00e1ria e Social). Conforme os filtros de \u00e1rea s\u00e3o aplicados, os valores s\u00e3o atualizados para regi\u00e3o selecionada. Tamb\u00e9m \u00e9 poss\u00edvel visualizar o percentual do indicador sob a \u00e1rea total da regi\u00e3o. Como \u00e9 ilustrado na imagem logo abaixo, o Brasil possui 175.361.556 hectares de \u00e1reas de pastagens, o que equivale a 20,63% de toda \u00e1rea nacional. 2 - Mapa interativo \u00c1rea onde todos os indicadores contidos na plataforma podem ser visualizados no mapa, para an\u00e1lises e compara\u00e7\u00f5es com outros indicadores. Na imagem seguinte temos um exemplo de visualiza\u00e7\u00e3o de indicadores no mapa: indicadores de \u00e1reas de pastagens na cor amarela e frigor\u00edficos na cor vermelha. 3 - Controle de Visualiza\u00e7\u00e3o Permite o controle do n\u00edvel de zoom do mapa, al\u00e9m de ocultar e ativar a visualiza\u00e7\u00e3o da lista de indicadores, controle das legendas dos dados ativos no mapa. O mapa base tamb\u00e9m pode ser alterado conforme a necessidade de an\u00e1lise do usu\u00e1rio. E por \u00faltimo o \u00edcone de \"lupa\" ferramenta para pesquisa de propriedade por meio do c\u00f3digo do Cadastro Ambiental Rural - CAR. 4 - Legenda As legendas dos dados ativos no mapa contam com um controle de visualiza\u00e7\u00e3o, sobreposi\u00e7\u00e3o de camadas e tamb\u00e9m opacidade o que contribui para uma melhor an\u00e1lise do usu\u00e1rio. Ferramenta de pesquisa por propriedade do CAR O \u00edcone de \"lupa\" \u00e9 uma ferramenta desenvolvida para pesquisa de propriedade por meio do c\u00f3digo do Cadastro Ambiental Rural - CAR. Ao inserir um c\u00f3digo de propriedade o limite \u00e9 evidenciado no mapa e o usu\u00e1rio pode selecionar os indicadores que deseja analisar. Ferramenta de Gerar Relat\u00f3rio Um dos recursos mais importantes da plataforma \u00e9 o \u201cGerar relat\u00f3rio\u201d, que traz em formato de gr\u00e1fico as s\u00e9ries hist\u00f3ricas do(s) dado(s) selecionado(s) para uma determinada regi\u00e3o definida pelo usu\u00e1rio. Caso o dado n\u00e3o seja temporal, o valor \u00e9 mostrado apenas para o ano de cria\u00e7\u00e3o do indicador, como \u00e9 o caso do dado de Unidades de Conserva\u00e7\u00e3o de Prote\u00e7\u00e3o Integral (2014), Frigor\u00edficos e Matadouros (2017) e Floresta Plantada(2014). Relat\u00f3rio em formato de gr\u00e1fico da produ\u00e7\u00e3o de soja em toneladas, mostrando a sua evolu\u00e7\u00e3o temporal (2000 a 2015) na regi\u00e3o do bioma Cerrado. Destaca-se tamb\u00e9m a possibilidade de visualizar o ranking dos 10 primeiros e 10 \u00faltimos Munic\u00edpios para o indicador escolhido, levando em considera\u00e7\u00e3o o ano e regi\u00e3o selecionada. O ranking apresenta a posi\u00e7\u00e3o, nome do munic\u00edpio, UF e valor do indicador. Ferramenta de Download de propriedades Sicar Ferramenta acess\u00edvel por meio do link . Ferramenta de Download Por fim, os usu\u00e1rios podem fazer o download dos indicadores em formato shapefile ou CSV, assim como recuperar o relat\u00f3rio em formato CSV.","title":"Funcionalidades"},{"location":"01-guia_funcionalidades/#funcionalidades","text":"A abordagem da plataforma baseia-se em apresentar um vasto conjunto de dados secund\u00e1rios relevantes (fontes oficiais e dados de refer\u00eancia) em um mapa interativo de f\u00e1cil navega\u00e7\u00e3o. Todos os indicadores s\u00e3o listados j\u00e1 com seus respectivos valores, logo na p\u00e1gina inicial da plataforma, promovendo assim o acesso mais r\u00e1pido a informa\u00e7\u00e3o.","title":"Funcionalidades"},{"location":"01-guia_funcionalidades/#dashboard","text":"O dashboard da Plataforma Risco Socioambiental \u00e9 formado por quatro elementos principais: 1 - Indicadores A unidade de refer\u00eancia s\u00e3o os munic\u00edpios, mas tamb\u00e9m \u00e9 poss\u00edvel fazer an\u00e1lises considerando todo o territ\u00f3rio nacional, estados, biomas e regi\u00f5es espec\u00edficas de interesse (como o Matopiba e Arco do Desmatamento). Os indicadores tamb\u00e9m podem ser agrupados por categorias (Agricultura, Ambiental Econ\u00f4mico, Natural, Pecu\u00e1ria e Social). Conforme os filtros de \u00e1rea s\u00e3o aplicados, os valores s\u00e3o atualizados para regi\u00e3o selecionada. Tamb\u00e9m \u00e9 poss\u00edvel visualizar o percentual do indicador sob a \u00e1rea total da regi\u00e3o. Como \u00e9 ilustrado na imagem logo abaixo, o Brasil possui 175.361.556 hectares de \u00e1reas de pastagens, o que equivale a 20,63% de toda \u00e1rea nacional. 2 - Mapa interativo \u00c1rea onde todos os indicadores contidos na plataforma podem ser visualizados no mapa, para an\u00e1lises e compara\u00e7\u00f5es com outros indicadores. Na imagem seguinte temos um exemplo de visualiza\u00e7\u00e3o de indicadores no mapa: indicadores de \u00e1reas de pastagens na cor amarela e frigor\u00edficos na cor vermelha. 3 - Controle de Visualiza\u00e7\u00e3o Permite o controle do n\u00edvel de zoom do mapa, al\u00e9m de ocultar e ativar a visualiza\u00e7\u00e3o da lista de indicadores, controle das legendas dos dados ativos no mapa. O mapa base tamb\u00e9m pode ser alterado conforme a necessidade de an\u00e1lise do usu\u00e1rio. E por \u00faltimo o \u00edcone de \"lupa\" ferramenta para pesquisa de propriedade por meio do c\u00f3digo do Cadastro Ambiental Rural - CAR. 4 - Legenda As legendas dos dados ativos no mapa contam com um controle de visualiza\u00e7\u00e3o, sobreposi\u00e7\u00e3o de camadas e tamb\u00e9m opacidade o que contribui para uma melhor an\u00e1lise do usu\u00e1rio.","title":"Dashboard"},{"location":"01-guia_funcionalidades/#ferramenta-de-pesquisa-por-propriedade-do-car","text":"O \u00edcone de \"lupa\" \u00e9 uma ferramenta desenvolvida para pesquisa de propriedade por meio do c\u00f3digo do Cadastro Ambiental Rural - CAR. Ao inserir um c\u00f3digo de propriedade o limite \u00e9 evidenciado no mapa e o usu\u00e1rio pode selecionar os indicadores que deseja analisar.","title":"Ferramenta de pesquisa por propriedade do CAR"},{"location":"01-guia_funcionalidades/#ferramenta-de-gerar-relatorio","text":"Um dos recursos mais importantes da plataforma \u00e9 o \u201cGerar relat\u00f3rio\u201d, que traz em formato de gr\u00e1fico as s\u00e9ries hist\u00f3ricas do(s) dado(s) selecionado(s) para uma determinada regi\u00e3o definida pelo usu\u00e1rio. Caso o dado n\u00e3o seja temporal, o valor \u00e9 mostrado apenas para o ano de cria\u00e7\u00e3o do indicador, como \u00e9 o caso do dado de Unidades de Conserva\u00e7\u00e3o de Prote\u00e7\u00e3o Integral (2014), Frigor\u00edficos e Matadouros (2017) e Floresta Plantada(2014). Relat\u00f3rio em formato de gr\u00e1fico da produ\u00e7\u00e3o de soja em toneladas, mostrando a sua evolu\u00e7\u00e3o temporal (2000 a 2015) na regi\u00e3o do bioma Cerrado. Destaca-se tamb\u00e9m a possibilidade de visualizar o ranking dos 10 primeiros e 10 \u00faltimos Munic\u00edpios para o indicador escolhido, levando em considera\u00e7\u00e3o o ano e regi\u00e3o selecionada. O ranking apresenta a posi\u00e7\u00e3o, nome do munic\u00edpio, UF e valor do indicador.","title":"Ferramenta de Gerar Relat\u00f3rio"},{"location":"01-guia_funcionalidades/#ferramenta-de-download-de-propriedades-sicar","text":"Ferramenta acess\u00edvel por meio do link .","title":"Ferramenta de Download de propriedades Sicar"},{"location":"01-guia_funcionalidades/#ferramenta-de-download","text":"Por fim, os usu\u00e1rios podem fazer o download dos indicadores em formato shapefile ou CSV, assim como recuperar o relat\u00f3rio em formato CSV.","title":"Ferramenta de Download"},{"location":"01-guia_indicadores/","text":"Relat\u00f3rios Relat\u00f3rio do estado/municipio O Cerrado DPAT permite a visualiza\u00e7\u00e3o de estat\u00edsticas e camadas para cada um dos estados e 1.386 munic\u00edpios do bioma Cerrado. Estes munic\u00edpios podem ser selecionados por meio de uma busca r\u00e1pida localizada na \u201cCamada de Dados\u201d. Assim, um zoom \u00e9 aplicado para a \u00e1rea de interesse, junto com estat\u00edsticas referentes \u00e0 s\u00e9rie hist\u00f3rica dos dados PRODES-Cerrado, uso e cobertura do solo no ano de 2013 (dados Terraclass Cerrado), e \u00e1rea agr\u00edcola mapeada durante a safra 2013/14 (dados Agrosat\u00e9lite). Al\u00e9m dos dados previamente carregados, destaca-se tamb\u00e9m a possibilidade da ativa\u00e7\u00e3o de todas as camadas de dados (e.g., declividade, solos, susceptibilidade ao desmatamento, precipita\u00e7\u00e3o, unidades de conserva\u00e7\u00e3o, terras ind\u00edgenas, terras quilombolas, dados do CAR, florestas plantadas, silos e armaz\u00e9ns, rodovias e frigor\u00edficos pertencentes ao sistema de inspe\u00e7\u00e3o federal). Relat\u00f3rio do pol\u00edgono Com o prop\u00f3sito de contextualizar cada \u00e1rea desmatada pelo PRODES-Cerrado, tamb\u00e9m apresentamos um relat\u00f3rio individual para cada pol\u00edgono detectado. Este relat\u00f3rio apresenta seis se\u00e7\u00f5es: Informa\u00e7\u00f5es Sobre o Pol\u00edgono, \u00c1reas Especiais, Cadastro Ambiental Rural (CAR), Valida\u00e7\u00e3o de Campo, Valida\u00e7\u00e3o Amostral e Hist\u00f3rico de Imagens Landsat, e, An\u00e1lise Autom\u00e1tica. A primeira se\u00e7\u00e3o apresenta os dados disponibilizados pelo INPE para cada detec\u00e7\u00e3o: sistema (PRODES-Cerrado ou DETER-Cerrado), \u00e1rea desmatada (em km\u00b2), munic\u00edpio, estado, data de detec\u00e7\u00e3o, latitude, longitude al\u00e9m dos limites do desmatamentos sobre a imagem inspecionada pelo INPE para a sua respectiva detec\u00e7\u00e3o. Nesta mesma se\u00e7\u00e3o \u00e9 informado a classe atribu\u00edda ao pol\u00edgono (A, B, C, D ou E). A se\u00e7\u00e3o \u201c\u00c1reas Especiais\u201d apresenta a dist\u00e2ncia do pol\u00edgono em rela\u00e7\u00e3o \u00e0 Terra Ind\u00edgena, Unidade de Conserva\u00e7\u00e3o (Uso Sustent\u00e1vel e Prote\u00e7\u00e3o Integral) e \u00c1rea Quilombola mais pr\u00f3xima. No caso de intersec\u00e7\u00e3o com alguma destas \u00e1reas, ou se a \u00e1rea estiver dentro de uma dist\u00e2ncia de 10 km, a localiza\u00e7\u00e3o do pol\u00edgono \u00e9 mostrada em conjunto com os respectivos limites da \u00e1rea especial em quest\u00e3o. As intersec\u00e7\u00f5es do pol\u00edgono desmatado com os dados do CAR (limite da propriedade, APP, Reserva Legal e Nascentes), assim como as \u00e1reas (km\u00b2) de cada uma destas intersec\u00e7\u00f5es, s\u00e3o apresentadas na se\u00e7\u00e3o \u201cCadastro Ambiental Rural (CAR)\u201d. Os dados coletados nas atividades de campo realizadas no \u00e2mbito do projeto FIP Monitoramento s\u00e3o disponibilizadas ao p\u00fablico por meio da se\u00e7\u00e3o \u201cValida\u00e7\u00e3o de Campo\u201d. Nela s\u00e3o apresentadas tanto fotos registradas em solo, quanto fotos e v\u00eddeos a\u00e9reos registrados por drones. Na se\u00e7\u00e3o \u201cValida\u00e7\u00e3o Amostral e Hist\u00f3rico de Imagens Landsat\u201d, o usu\u00e1rio da plataforma tem acesso \u00e0s imagens inspecionadas para a detec\u00e7\u00e3o dos desmatamentos no \u00e2mbito do sistema PRODES-Cerrado. Tamb\u00e9m s\u00e3o disponibilizados os pontos visualmente inspecionados no \u00e2mbito da valida\u00e7\u00e3o amostral realizada pelo Laborat\u00f3rio de Processamento de Imagens e Geoprocessamento (Lapig) da Universidade Federal de Goi\u00e1s (UFG). As composi\u00e7\u00f5es adotadas para os sensores Landsat TM (R4 G5 B3) e Landsat OLI (R5 G6 4B) real\u00e7am, em vermelho, a vegeta\u00e7\u00e3o fotossinteticamente ativa. Os tons esverdeados correspondem tanto a \u00e1reas com vegeta\u00e7\u00e3o esparsa e baixo porte (textura heterog\u00eanea) quanto solo exposto (textura homog\u00eanea). Cicatrizes de queimadas s\u00e3o observadas na cor azul escuro, solos expostos podem ser observados na cor azul clara, e palhada de agricultura, em tonalidades esbranqui\u00e7adas. Ap\u00f3s a visualiza\u00e7\u00e3o da s\u00e9rie hist\u00f3rica de imagens Landsat, uma s\u00e9rie temporal obtida pelo sensor MODIS a partir de valores mensais do \u00edndice de vegeta\u00e7\u00e3o Normalized Difference Vegetation Index (NDVI), tamb\u00e9m permite uma melhor compreens\u00e3o sazonal do comportamento da vegeta\u00e7\u00e3o desmatada. Por fim, uma an\u00e1lise autom\u00e1tica \u00e9 aplicada a todos os pol\u00edgonos de desmatamento identificados. Ela se constitui de contextualiza\u00e7\u00f5es geogr\u00e1ficas e espectro temporais, respectivamente representadas pela superf\u00edcie de susceptibilidade ao desmatamento (desmatamentos grandes e pequenos) e pelo resultado do uso do algoritmo B-Fast Monitor (utilizada para a detec\u00e7\u00e3o de quebras de tend\u00eancias em s\u00e9ries temporais) em s\u00e9ries MODIS. Relat\u00f3rio da \u00e1rea submetida Ap\u00f3s o envio do arquivo espacializado, o usu\u00e1rio tem a op\u00e7\u00e3o de analisar a \u00e1rea submetida com um clique sobre o bot\u00e3o \u201cAnalisar\u201d. Essa an\u00e1lise permite a visualiza\u00e7\u00e3o de um relat\u00f3rio com a \u00e1rea total, os munic\u00edpios, e os estados que cruzam com a \u00e1rea submetida. Tamb\u00e9m s\u00e3o expostas as \u00e1reas totais anuais dos avisos provenientes do DETER-Cerrado e dos desmatamentos detectados pelo PRODES-Cerrado. Observa-se na figura abaixo a sobreposi\u00e7\u00e3o de desmatamentos (contorno em rosa) com uma \u00c1rea Priorit\u00e1ria Para Conserva\u00e7\u00e3o da Biodiversidade (Entorno da Terra Indigena Xerente) de Import\u00e2ncia Biol\u00f3gica \u201cExtremamente Alta\u201d e Prioridade de A\u00e7\u00e3o \u201cExtremamente Alta\u201d. Tamb\u00e9m \u00e9 poss\u00edvel identificar, em vermelho, as \u00e1reas nativas mais suscept\u00edveis ao desmatamento. Destaca-se tamb\u00e9m a funcionalidade de visualiza\u00e7\u00e3o dos registros CAR referentes aos 50 maiores desmatamentos detectados dentro da \u00e1rea submetida. Al\u00e9m do c\u00f3digo da respectiva propriedade, tamb\u00e9m s\u00e3o disponibilizados dados de \u00e1rea desmatada por CAR (km\u00b2), \u00e1rea de reserva legal total da propriedade (km\u00b2), \u00e1rea desmatada em reserva legal (km\u00b2), \u00e1rea total de APP da propriedade (km\u00b2) e \u00e1rea desmatada em APP da propriedade (km\u00b2).","title":"Indicadores"},{"location":"01-guia_indicadores/#relatorios","text":"","title":"Relat\u00f3rios"},{"location":"01-guia_indicadores/#relatorio-do-estadomunicipio","text":"O Cerrado DPAT permite a visualiza\u00e7\u00e3o de estat\u00edsticas e camadas para cada um dos estados e 1.386 munic\u00edpios do bioma Cerrado. Estes munic\u00edpios podem ser selecionados por meio de uma busca r\u00e1pida localizada na \u201cCamada de Dados\u201d. Assim, um zoom \u00e9 aplicado para a \u00e1rea de interesse, junto com estat\u00edsticas referentes \u00e0 s\u00e9rie hist\u00f3rica dos dados PRODES-Cerrado, uso e cobertura do solo no ano de 2013 (dados Terraclass Cerrado), e \u00e1rea agr\u00edcola mapeada durante a safra 2013/14 (dados Agrosat\u00e9lite). Al\u00e9m dos dados previamente carregados, destaca-se tamb\u00e9m a possibilidade da ativa\u00e7\u00e3o de todas as camadas de dados (e.g., declividade, solos, susceptibilidade ao desmatamento, precipita\u00e7\u00e3o, unidades de conserva\u00e7\u00e3o, terras ind\u00edgenas, terras quilombolas, dados do CAR, florestas plantadas, silos e armaz\u00e9ns, rodovias e frigor\u00edficos pertencentes ao sistema de inspe\u00e7\u00e3o federal).","title":"Relat\u00f3rio do estado/municipio"},{"location":"01-guia_indicadores/#relatorio-do-poligono","text":"Com o prop\u00f3sito de contextualizar cada \u00e1rea desmatada pelo PRODES-Cerrado, tamb\u00e9m apresentamos um relat\u00f3rio individual para cada pol\u00edgono detectado. Este relat\u00f3rio apresenta seis se\u00e7\u00f5es: Informa\u00e7\u00f5es Sobre o Pol\u00edgono, \u00c1reas Especiais, Cadastro Ambiental Rural (CAR), Valida\u00e7\u00e3o de Campo, Valida\u00e7\u00e3o Amostral e Hist\u00f3rico de Imagens Landsat, e, An\u00e1lise Autom\u00e1tica. A primeira se\u00e7\u00e3o apresenta os dados disponibilizados pelo INPE para cada detec\u00e7\u00e3o: sistema (PRODES-Cerrado ou DETER-Cerrado), \u00e1rea desmatada (em km\u00b2), munic\u00edpio, estado, data de detec\u00e7\u00e3o, latitude, longitude al\u00e9m dos limites do desmatamentos sobre a imagem inspecionada pelo INPE para a sua respectiva detec\u00e7\u00e3o. Nesta mesma se\u00e7\u00e3o \u00e9 informado a classe atribu\u00edda ao pol\u00edgono (A, B, C, D ou E). A se\u00e7\u00e3o \u201c\u00c1reas Especiais\u201d apresenta a dist\u00e2ncia do pol\u00edgono em rela\u00e7\u00e3o \u00e0 Terra Ind\u00edgena, Unidade de Conserva\u00e7\u00e3o (Uso Sustent\u00e1vel e Prote\u00e7\u00e3o Integral) e \u00c1rea Quilombola mais pr\u00f3xima. No caso de intersec\u00e7\u00e3o com alguma destas \u00e1reas, ou se a \u00e1rea estiver dentro de uma dist\u00e2ncia de 10 km, a localiza\u00e7\u00e3o do pol\u00edgono \u00e9 mostrada em conjunto com os respectivos limites da \u00e1rea especial em quest\u00e3o. As intersec\u00e7\u00f5es do pol\u00edgono desmatado com os dados do CAR (limite da propriedade, APP, Reserva Legal e Nascentes), assim como as \u00e1reas (km\u00b2) de cada uma destas intersec\u00e7\u00f5es, s\u00e3o apresentadas na se\u00e7\u00e3o \u201cCadastro Ambiental Rural (CAR)\u201d. Os dados coletados nas atividades de campo realizadas no \u00e2mbito do projeto FIP Monitoramento s\u00e3o disponibilizadas ao p\u00fablico por meio da se\u00e7\u00e3o \u201cValida\u00e7\u00e3o de Campo\u201d. Nela s\u00e3o apresentadas tanto fotos registradas em solo, quanto fotos e v\u00eddeos a\u00e9reos registrados por drones. Na se\u00e7\u00e3o \u201cValida\u00e7\u00e3o Amostral e Hist\u00f3rico de Imagens Landsat\u201d, o usu\u00e1rio da plataforma tem acesso \u00e0s imagens inspecionadas para a detec\u00e7\u00e3o dos desmatamentos no \u00e2mbito do sistema PRODES-Cerrado. Tamb\u00e9m s\u00e3o disponibilizados os pontos visualmente inspecionados no \u00e2mbito da valida\u00e7\u00e3o amostral realizada pelo Laborat\u00f3rio de Processamento de Imagens e Geoprocessamento (Lapig) da Universidade Federal de Goi\u00e1s (UFG). As composi\u00e7\u00f5es adotadas para os sensores Landsat TM (R4 G5 B3) e Landsat OLI (R5 G6 4B) real\u00e7am, em vermelho, a vegeta\u00e7\u00e3o fotossinteticamente ativa. Os tons esverdeados correspondem tanto a \u00e1reas com vegeta\u00e7\u00e3o esparsa e baixo porte (textura heterog\u00eanea) quanto solo exposto (textura homog\u00eanea). Cicatrizes de queimadas s\u00e3o observadas na cor azul escuro, solos expostos podem ser observados na cor azul clara, e palhada de agricultura, em tonalidades esbranqui\u00e7adas. Ap\u00f3s a visualiza\u00e7\u00e3o da s\u00e9rie hist\u00f3rica de imagens Landsat, uma s\u00e9rie temporal obtida pelo sensor MODIS a partir de valores mensais do \u00edndice de vegeta\u00e7\u00e3o Normalized Difference Vegetation Index (NDVI), tamb\u00e9m permite uma melhor compreens\u00e3o sazonal do comportamento da vegeta\u00e7\u00e3o desmatada. Por fim, uma an\u00e1lise autom\u00e1tica \u00e9 aplicada a todos os pol\u00edgonos de desmatamento identificados. Ela se constitui de contextualiza\u00e7\u00f5es geogr\u00e1ficas e espectro temporais, respectivamente representadas pela superf\u00edcie de susceptibilidade ao desmatamento (desmatamentos grandes e pequenos) e pelo resultado do uso do algoritmo B-Fast Monitor (utilizada para a detec\u00e7\u00e3o de quebras de tend\u00eancias em s\u00e9ries temporais) em s\u00e9ries MODIS.","title":"Relat\u00f3rio do pol\u00edgono"},{"location":"01-guia_indicadores/#relatorio-da-area-submetida","text":"Ap\u00f3s o envio do arquivo espacializado, o usu\u00e1rio tem a op\u00e7\u00e3o de analisar a \u00e1rea submetida com um clique sobre o bot\u00e3o \u201cAnalisar\u201d. Essa an\u00e1lise permite a visualiza\u00e7\u00e3o de um relat\u00f3rio com a \u00e1rea total, os munic\u00edpios, e os estados que cruzam com a \u00e1rea submetida. Tamb\u00e9m s\u00e3o expostas as \u00e1reas totais anuais dos avisos provenientes do DETER-Cerrado e dos desmatamentos detectados pelo PRODES-Cerrado. Observa-se na figura abaixo a sobreposi\u00e7\u00e3o de desmatamentos (contorno em rosa) com uma \u00c1rea Priorit\u00e1ria Para Conserva\u00e7\u00e3o da Biodiversidade (Entorno da Terra Indigena Xerente) de Import\u00e2ncia Biol\u00f3gica \u201cExtremamente Alta\u201d e Prioridade de A\u00e7\u00e3o \u201cExtremamente Alta\u201d. Tamb\u00e9m \u00e9 poss\u00edvel identificar, em vermelho, as \u00e1reas nativas mais suscept\u00edveis ao desmatamento. Destaca-se tamb\u00e9m a funcionalidade de visualiza\u00e7\u00e3o dos registros CAR referentes aos 50 maiores desmatamentos detectados dentro da \u00e1rea submetida. Al\u00e9m do c\u00f3digo da respectiva propriedade, tamb\u00e9m s\u00e3o disponibilizados dados de \u00e1rea desmatada por CAR (km\u00b2), \u00e1rea de reserva legal total da propriedade (km\u00b2), \u00e1rea desmatada em reserva legal (km\u00b2), \u00e1rea total de APP da propriedade (km\u00b2) e \u00e1rea desmatada em APP da propriedade (km\u00b2).","title":"Relat\u00f3rio da \u00e1rea submetida"},{"location":"02-arq_execucao_risco/","text":"Introdu\u00e7\u00e3o Conforme detalhado na se\u00e7\u00e3o Arquitetura de Software , para execu\u00e7\u00e3o do RISCOSOCIOAMBIENTAL s\u00e3o necess\u00e1rias 4 estruturas criadas e funcionais na m\u00e1quina do usu\u00e1rio: O Banco de Dados wwf-sicar restaurado no servi\u00e7o do MONGODB. O servi\u00e7o OWS Server devidamente configurado e executando em um IP e porta. O Application Server e client (Front-end) da aplica\u00e7\u00e3o compilados e executando. O Banco de Dados indicadores.sqlite na pasta /storage/catalog/Ocultos, criada pelo script. Deployment da aplica\u00e7\u00e3o RISCOSOCIOAMBIENTAL e OWS Server A fim facilitar/automatizar todo o processo de execu\u00e7\u00e3o do Riscosocioambiental e OWS Server foi criado um script que executa todos os passos necess\u00e1rios. Este script dever\u00e1 executar as seguintes tarefas: Download do cont\u00e2iner do CONTAINER_OWS.tar.gz Download do cont\u00e2iner do CONTAINER_SOCIOAMBIENTAL.tar.gz Download do cont\u00e2iner do CONTAINER_MONGODB.tar.gz Cria a estrutura de pastas necess\u00e1rias (ows-cache, catalog, Ocultos e riscosocioambiental) para funcionamento do OWS Server e riscosocioambiental Constr\u00f3i a aplica\u00e7\u00e3o do OWS Server e a disponibiliza em um IP e porta. Constr\u00f3i a aplica\u00e7\u00e3o do RISCOSOCIOAMBIENTAL e a disponibiliza em um IP e porta. Constr\u00f3i a aplica\u00e7\u00e3o do MONGODB-SERVER e a disponibiliza em um IP e porta. Conforme mencionado anteriormente, a estrutura do OWS Server, RISCOSOCIOAMBIENTAL e MONGODB-SERVER foi constru\u00edda com o apoio do Docker , portanto para instala\u00e7\u00e3o do mesmo, deve-se seguir os passos definidos nos tutoriais de acordo com o sistema operacional, seja ele Debian ou CentOS . Al\u00e9m do Docker, o script tamb\u00e9m faz uso das seguintes depend\u00eancias: Depend\u00eancia Tutorial para Instala\u00e7\u00e3o Perl https://learn.perl.org/installing/unix_linux.html wget https://www.cyberciti.biz/faq/how-to-install-wget-togetrid-of-error-bash-wget-command-not-found/ curl https://www.cyberciti.biz/faq/how-to-install-curl-command-on-a-ubuntu-linux/ Git https://gist.github.com/derhuerst/1b15ff4652a867391f03 Ap\u00f3s instala\u00e7\u00e3o do Docker e das depend\u00eancias m\u00ednimas para o script, deve-se executar o script start-socio+ows.sh atrav\u00e9s do comando: $ ./start-socio+ows.sh Inicialmente o script ir\u00e1 pedir ao usu\u00e1rio que informe o local onde o OWS Server e RISCOSOCIOAMBIENTAL dever\u00e1 criar a estrutura de pastas necess\u00e1rias para funcionamento. Na imagem abaixo, o usu\u00e1rio ter\u00e1 informado o caminho /data/containers . \u00c9 importante ressaltar que este dever\u00e1 ser um caminho v\u00e1lido na m\u00e1quina do usu\u00e1rio. Em seguida, deve-se informar o diret\u00f3rio onde o cache dever\u00e1 ser armazenado. Na imagem abaixo, o usu\u00e1rio ter\u00e1 informado novamente o caminho /storage . por\u00e9m, como o OWS Server est\u00e1 armazenado em um cont\u00e2iner Docker, o script ir\u00e1 mapear automaticamente este caminho para /STORAGE dentro da estrutura do Docker. Ap\u00f3s a inicializa\u00e7\u00e3o do das vari\u00e1veis necess\u00e1rias o script ir\u00e1 realizar automaticamente o download do cont\u00e2iner do OWS Server, RISCOSOCIOAMBIENTAL,MONGODB-SERVER e import\u00e1-los corretamente no Docker instalado na m\u00e1quina do usu\u00e1rio. Ap\u00f3s a importa\u00e7\u00e3o correta do cont\u00e2iner, o OWS Server dever\u00e1 estar executando e aguardando requisi\u00e7\u00f5es em localhost ou 127.0.0.1 na porta 5000 . A imagem abaixo apresenta um exemplo de requsi\u00e7\u00e3o feita atrav\u00e9s do curl no endere\u00e7o http://127.0.0.1:5000/ows , que recebe uma pequena p\u00e1gina HTML criada pelo MapServer. Ap\u00f3s a importa\u00e7\u00e3o correta do cont\u00e2iner, o RISCOSOCIOAMBIENTAL dever\u00e1 estar executando e aguardando requisi\u00e7\u00f5es em localhost ou 127.0.0.1 na porta 2000 . A imagem abaixo apresenta um exemplo de requsi\u00e7\u00e3o feita atrav\u00e9s do NAVEGADOR no endere\u00e7o http://127.0.0.1:2000 , que recebe a p\u00e1gina do RISCOSOCIOAMBIENTAL. Ap\u00f3s a execu\u00e7\u00e3o do OWS Server e RISCOSOCIOAMBIENTAL, tamb\u00e9m \u00e9 necess\u00e1rio mover o indicadores.sqlite presentes no link para dentro da pasta /storage/catalog/Ocultos criada no caminho informado pelo usu\u00e1rio no in\u00edcio do script. Por fim, vale ressaltar que uma vez que o cont\u00e2iner do OWS Server esteja configurado e funcionando n\u00e3o \u00e9 mais necess\u00e1rio executar o script start-ows.sh . J\u00e1 existe um script na raiz do cont\u00e2iner que \u00e9 respons\u00e1vel por executar o OWS Server imediatamente ap\u00f3s o cont\u00e2iner ser inicializado. Portanto, basta executar: OBS: Dentro da pasta /catalog/Ocultos/ deve existir os dois arquivos indicadores.sqlite e indicadores.map , caso nao exista os dois nao ir\u00e1 funcionar a aplica\u00e7\u00e3o. $ docker restart OWS bash E caso deseja entrar no cont\u00e2iner do OWS-SERVER e verificar os arquivos internos, tais como logs de requisi\u00e7\u00f5es, basta executar: $ docker exec -it OWS bash $ cd /APP/lapig-maps/src/ows/log $ tail -f ows-mapserv.log E caso deseja entrar no cont\u00e2iner do OWS-SOCIOAMBIENTAL e verificar os arquivos internos, tais como logs de requisi\u00e7\u00f5es, basta executar: $ docker exec -it APP_SOCIOAMBIENTAL bash $ cd /APP/riscosocioambiental/server $ tail -f app.out E caso deseja entrar no cont\u00e2iner do MONGODB-SERVER e verificar se o banco foi restaurado com sucesso, tais como logs de requisi\u00e7\u00f5es, basta executar: $ docker exec -it APP_SOCIOAMBIENTAL bash $ cd /APP/dump $ cat log-restore.out Cria\u00e7\u00e3o do Ambiente de Desenvolvimento A seguir ser\u00e1 abordado como executar a aplica\u00e7\u00e3o RISCOSOCIOAMBIENTAL em ambiente de Desenvolvimento. Para o ambiente de desenvolvimento ser\u00e1 detalhado um passo a passo partindo do pressuposto que um programador ir\u00e1 dar manuten\u00e7\u00e3o ou continuidade no RISCOSOCIOAMBIENTAL. J\u00e1 o ambiente de produ\u00e7\u00e3o, ser\u00e1 disponibilizado via script que executa todos os passos para disponibilizar o RISCOSOCIOAMBIENTAL em uma porta da m\u00e1quina que est\u00e1 sendo executado. Assim como abordado na se\u00e7\u00e3o , o RISCOSOCIOAMBIENTAL foi constru\u00eddo com NodeJS como Application Server e Angular como cliente ( WebMap Client ). Portanto, primeiramente \u00e9 necess\u00e1ria a instala\u00e7\u00e3o destes componentes na m\u00e1quina do desenvolvedor. Para tal, pode-se seguir o passo-a-passo elaborado neste link Para execu\u00e7\u00e3o do RISCOSOCIOAMBIENTAL em ambiente de desenvolvimento, primeiramente \u00e9 necess\u00e1rio realizar um fork do projeto para a sua conta pessoal do Github e em seguida executar um git clone do reposit\u00f3rio do projeto . Para inicializar o servidor de aplica\u00e7\u00e3o ( Application Server ) deve-se executar o passo-a-passo descrito na se\u00e7\u00e3o . A execu\u00e7\u00e3o da mesma ir\u00e1 inicializar o Application Server em localhost na porta 3000. Para verificar o seu funcionamento, pode-se realizar a requisi\u00e7\u00e3o abaixo em um navegador qualquer, que dever\u00e1 apresentar um resultado semelhante a este . http://localhost:3000/service/deforestation/largest?year=2019 amount=15 Em seguida, para inicializar o WebMap Client localizado na pasta src/client , basta navegar at\u00e9 a pasta client e instalar as depend\u00eancias listadas no package.json atrav\u00e9s do comando: $ npm install Ap\u00f3s a devida instala\u00e7\u00e3o das depend\u00eancias, pode-se ent\u00e3o compilar e inicializar a aplica\u00e7\u00e3o. Mais uma vez, a fim de facilitar, foi criado um script start.sh para inicializar o WebMap Client , portanto basta executar: $ ./src/client/start.sh Ao finalizar a compila\u00e7\u00e3o do projeto, a aplica\u00e7\u00e3o estar\u00e1 executando em localhost na porta padr\u00e3o do Angular, que \u00e9 a porta 4200. Portanto, para acessar a p\u00e1gina Web criada pela aplica\u00e7\u00e3o, acesse pelo navegador: http://localhost:4200 Ap\u00f3s execu\u00e7\u00e3o dos scripts o OWS Server estar\u00e1 executando na m\u00e1quina do usu\u00e1rio na porta 5000 e o RISCOSOCIOAMBIENTAL tamb\u00e9m na m\u00e1quina do usu\u00e1rio na porta 3000 .","title":"Deployment da arquitetura do Riscosocioambiental"},{"location":"02-arq_execucao_risco/#introducao","text":"Conforme detalhado na se\u00e7\u00e3o Arquitetura de Software , para execu\u00e7\u00e3o do RISCOSOCIOAMBIENTAL s\u00e3o necess\u00e1rias 4 estruturas criadas e funcionais na m\u00e1quina do usu\u00e1rio: O Banco de Dados wwf-sicar restaurado no servi\u00e7o do MONGODB. O servi\u00e7o OWS Server devidamente configurado e executando em um IP e porta. O Application Server e client (Front-end) da aplica\u00e7\u00e3o compilados e executando. O Banco de Dados indicadores.sqlite na pasta /storage/catalog/Ocultos, criada pelo script.","title":"Introdu\u00e7\u00e3o"},{"location":"02-arq_execucao_risco/#deployment-da-aplicacao-riscosocioambiental-e-ows-server","text":"A fim facilitar/automatizar todo o processo de execu\u00e7\u00e3o do Riscosocioambiental e OWS Server foi criado um script que executa todos os passos necess\u00e1rios. Este script dever\u00e1 executar as seguintes tarefas: Download do cont\u00e2iner do CONTAINER_OWS.tar.gz Download do cont\u00e2iner do CONTAINER_SOCIOAMBIENTAL.tar.gz Download do cont\u00e2iner do CONTAINER_MONGODB.tar.gz Cria a estrutura de pastas necess\u00e1rias (ows-cache, catalog, Ocultos e riscosocioambiental) para funcionamento do OWS Server e riscosocioambiental Constr\u00f3i a aplica\u00e7\u00e3o do OWS Server e a disponibiliza em um IP e porta. Constr\u00f3i a aplica\u00e7\u00e3o do RISCOSOCIOAMBIENTAL e a disponibiliza em um IP e porta. Constr\u00f3i a aplica\u00e7\u00e3o do MONGODB-SERVER e a disponibiliza em um IP e porta. Conforme mencionado anteriormente, a estrutura do OWS Server, RISCOSOCIOAMBIENTAL e MONGODB-SERVER foi constru\u00edda com o apoio do Docker , portanto para instala\u00e7\u00e3o do mesmo, deve-se seguir os passos definidos nos tutoriais de acordo com o sistema operacional, seja ele Debian ou CentOS . Al\u00e9m do Docker, o script tamb\u00e9m faz uso das seguintes depend\u00eancias: Depend\u00eancia Tutorial para Instala\u00e7\u00e3o Perl https://learn.perl.org/installing/unix_linux.html wget https://www.cyberciti.biz/faq/how-to-install-wget-togetrid-of-error-bash-wget-command-not-found/ curl https://www.cyberciti.biz/faq/how-to-install-curl-command-on-a-ubuntu-linux/ Git https://gist.github.com/derhuerst/1b15ff4652a867391f03 Ap\u00f3s instala\u00e7\u00e3o do Docker e das depend\u00eancias m\u00ednimas para o script, deve-se executar o script start-socio+ows.sh atrav\u00e9s do comando: $ ./start-socio+ows.sh Inicialmente o script ir\u00e1 pedir ao usu\u00e1rio que informe o local onde o OWS Server e RISCOSOCIOAMBIENTAL dever\u00e1 criar a estrutura de pastas necess\u00e1rias para funcionamento. Na imagem abaixo, o usu\u00e1rio ter\u00e1 informado o caminho /data/containers . \u00c9 importante ressaltar que este dever\u00e1 ser um caminho v\u00e1lido na m\u00e1quina do usu\u00e1rio. Em seguida, deve-se informar o diret\u00f3rio onde o cache dever\u00e1 ser armazenado. Na imagem abaixo, o usu\u00e1rio ter\u00e1 informado novamente o caminho /storage . por\u00e9m, como o OWS Server est\u00e1 armazenado em um cont\u00e2iner Docker, o script ir\u00e1 mapear automaticamente este caminho para /STORAGE dentro da estrutura do Docker. Ap\u00f3s a inicializa\u00e7\u00e3o do das vari\u00e1veis necess\u00e1rias o script ir\u00e1 realizar automaticamente o download do cont\u00e2iner do OWS Server, RISCOSOCIOAMBIENTAL,MONGODB-SERVER e import\u00e1-los corretamente no Docker instalado na m\u00e1quina do usu\u00e1rio. Ap\u00f3s a importa\u00e7\u00e3o correta do cont\u00e2iner, o OWS Server dever\u00e1 estar executando e aguardando requisi\u00e7\u00f5es em localhost ou 127.0.0.1 na porta 5000 . A imagem abaixo apresenta um exemplo de requsi\u00e7\u00e3o feita atrav\u00e9s do curl no endere\u00e7o http://127.0.0.1:5000/ows , que recebe uma pequena p\u00e1gina HTML criada pelo MapServer. Ap\u00f3s a importa\u00e7\u00e3o correta do cont\u00e2iner, o RISCOSOCIOAMBIENTAL dever\u00e1 estar executando e aguardando requisi\u00e7\u00f5es em localhost ou 127.0.0.1 na porta 2000 . A imagem abaixo apresenta um exemplo de requsi\u00e7\u00e3o feita atrav\u00e9s do NAVEGADOR no endere\u00e7o http://127.0.0.1:2000 , que recebe a p\u00e1gina do RISCOSOCIOAMBIENTAL. Ap\u00f3s a execu\u00e7\u00e3o do OWS Server e RISCOSOCIOAMBIENTAL, tamb\u00e9m \u00e9 necess\u00e1rio mover o indicadores.sqlite presentes no link para dentro da pasta /storage/catalog/Ocultos criada no caminho informado pelo usu\u00e1rio no in\u00edcio do script. Por fim, vale ressaltar que uma vez que o cont\u00e2iner do OWS Server esteja configurado e funcionando n\u00e3o \u00e9 mais necess\u00e1rio executar o script start-ows.sh . J\u00e1 existe um script na raiz do cont\u00e2iner que \u00e9 respons\u00e1vel por executar o OWS Server imediatamente ap\u00f3s o cont\u00e2iner ser inicializado. Portanto, basta executar: OBS: Dentro da pasta /catalog/Ocultos/ deve existir os dois arquivos indicadores.sqlite e indicadores.map , caso nao exista os dois nao ir\u00e1 funcionar a aplica\u00e7\u00e3o. $ docker restart OWS bash E caso deseja entrar no cont\u00e2iner do OWS-SERVER e verificar os arquivos internos, tais como logs de requisi\u00e7\u00f5es, basta executar: $ docker exec -it OWS bash $ cd /APP/lapig-maps/src/ows/log $ tail -f ows-mapserv.log E caso deseja entrar no cont\u00e2iner do OWS-SOCIOAMBIENTAL e verificar os arquivos internos, tais como logs de requisi\u00e7\u00f5es, basta executar: $ docker exec -it APP_SOCIOAMBIENTAL bash $ cd /APP/riscosocioambiental/server $ tail -f app.out E caso deseja entrar no cont\u00e2iner do MONGODB-SERVER e verificar se o banco foi restaurado com sucesso, tais como logs de requisi\u00e7\u00f5es, basta executar: $ docker exec -it APP_SOCIOAMBIENTAL bash $ cd /APP/dump $ cat log-restore.out","title":"Deployment da aplica\u00e7\u00e3o RISCOSOCIOAMBIENTAL e OWS Server"},{"location":"02-arq_execucao_risco/#criacao-do-ambiente-de-desenvolvimento","text":"A seguir ser\u00e1 abordado como executar a aplica\u00e7\u00e3o RISCOSOCIOAMBIENTAL em ambiente de Desenvolvimento. Para o ambiente de desenvolvimento ser\u00e1 detalhado um passo a passo partindo do pressuposto que um programador ir\u00e1 dar manuten\u00e7\u00e3o ou continuidade no RISCOSOCIOAMBIENTAL. J\u00e1 o ambiente de produ\u00e7\u00e3o, ser\u00e1 disponibilizado via script que executa todos os passos para disponibilizar o RISCOSOCIOAMBIENTAL em uma porta da m\u00e1quina que est\u00e1 sendo executado. Assim como abordado na se\u00e7\u00e3o , o RISCOSOCIOAMBIENTAL foi constru\u00eddo com NodeJS como Application Server e Angular como cliente ( WebMap Client ). Portanto, primeiramente \u00e9 necess\u00e1ria a instala\u00e7\u00e3o destes componentes na m\u00e1quina do desenvolvedor. Para tal, pode-se seguir o passo-a-passo elaborado neste link Para execu\u00e7\u00e3o do RISCOSOCIOAMBIENTAL em ambiente de desenvolvimento, primeiramente \u00e9 necess\u00e1rio realizar um fork do projeto para a sua conta pessoal do Github e em seguida executar um git clone do reposit\u00f3rio do projeto . Para inicializar o servidor de aplica\u00e7\u00e3o ( Application Server ) deve-se executar o passo-a-passo descrito na se\u00e7\u00e3o . A execu\u00e7\u00e3o da mesma ir\u00e1 inicializar o Application Server em localhost na porta 3000. Para verificar o seu funcionamento, pode-se realizar a requisi\u00e7\u00e3o abaixo em um navegador qualquer, que dever\u00e1 apresentar um resultado semelhante a este . http://localhost:3000/service/deforestation/largest?year=2019 amount=15 Em seguida, para inicializar o WebMap Client localizado na pasta src/client , basta navegar at\u00e9 a pasta client e instalar as depend\u00eancias listadas no package.json atrav\u00e9s do comando: $ npm install Ap\u00f3s a devida instala\u00e7\u00e3o das depend\u00eancias, pode-se ent\u00e3o compilar e inicializar a aplica\u00e7\u00e3o. Mais uma vez, a fim de facilitar, foi criado um script start.sh para inicializar o WebMap Client , portanto basta executar: $ ./src/client/start.sh Ao finalizar a compila\u00e7\u00e3o do projeto, a aplica\u00e7\u00e3o estar\u00e1 executando em localhost na porta padr\u00e3o do Angular, que \u00e9 a porta 4200. Portanto, para acessar a p\u00e1gina Web criada pela aplica\u00e7\u00e3o, acesse pelo navegador: http://localhost:4200 Ap\u00f3s execu\u00e7\u00e3o dos scripts o OWS Server estar\u00e1 executando na m\u00e1quina do usu\u00e1rio na porta 5000 e o RISCOSOCIOAMBIENTAL tamb\u00e9m na m\u00e1quina do usu\u00e1rio na porta 3000 .","title":"Cria\u00e7\u00e3o do Ambiente de Desenvolvimento"},{"location":"02-arq_geral/","text":"Arquitetura de software O Risco Socioambiental foi desenvolvido de acordo com os padr\u00f5es de interoperabilidade definidos pela Open Geospatial Consortium ( OGC ) e a arquitetura de webservices com o padr\u00e3o REST . Componentes de software A arquitetura de software desenvolvida para o Risco Socioambiental pode ser observada na Figura abaixo. Fernanda, tem que fazer uma figura parecida com esta por\u00e9m atualizando o Openlayers para Leaflet e PostgreSQL para SQLite Essencialmente, pode-se dividir o Risco Socioambiental em tr\u00eas partes: Client: respons\u00e1vel por apresentar toda a interface, constru\u00eddo em Angular 5 com apoio dos frameworks: WebMap: Mapa interativo constru\u00eddo com o Leaflet Componentes front-end : Fernanda olhe aqui os componentes utilizados (Bootstrap..? ) ou foi tudo apenas com CSS puro? Server: Disponibiliza os servi\u00e7os que comp\u00f5em a aplica\u00e7\u00e3o: Application Server: Disponibiliza o acesso aos dados do Data Source, an\u00e1lises e configura\u00e7\u00f5es. OWS Server : Disponibiliza o acesso ao MapServer , respons\u00e1vel pelo processamento dos dados geogr\u00e1ficos, apresenta\u00e7\u00e3o visual dos mesmos e gerenciamento de cache das imagens geradas. Data Source : Respons\u00e1vel por armazenar os dados vetoriais e matriciais. Resumidamente, todos os dados usados pelo Risco Socioambiental est\u00e3o organizados em um banco de dados SQLite e em sistemas de arquivos (Data Repository) . O SQLite \u00e9 armazenado tamb\u00e9m em arquivo e permite processar consultas espaciais via Structured Query Language (SQL). J\u00e1 os dados que n\u00e3o necessitam de cruzamentos espaciais s\u00e3o armazenados em arquivos nos formatos Shapefile e/ou GeoTIFF. Estes dados s\u00e3o acessados pelo Application Server e pelo OWS Server (ambos constru\u00eddos em NodeJS) e s\u00e3o disponibilizados atrav\u00e9s de URLs com requisi\u00e7\u00f5es por meio do protocolo HTTP . Todas as requisi\u00e7\u00f5es Web realizadas aos Servers s\u00e3o interceptadas pelo Apache Server e devidamente redirecionadas. Desta forma, o Client realiza todas as requisi\u00e7\u00f5es necess\u00e1rias para construir a visualiza\u00e7\u00e3o dos elementos da p\u00e1gina, tais como: mapa interativo, gr\u00e1ficos, campo de busca e etc. Por fim, destaca-se que todo o c\u00f3digo-fonte para o Risco Socioambiental e tamb\u00e9m para o OWS Server foi disponibilizado publicamente no Github do LAPIG/UFG .","title":"Vis\u00e3o geral"},{"location":"02-arq_geral/#arquitetura-de-software","text":"O Risco Socioambiental foi desenvolvido de acordo com os padr\u00f5es de interoperabilidade definidos pela Open Geospatial Consortium ( OGC ) e a arquitetura de webservices com o padr\u00e3o REST .","title":"Arquitetura de software"},{"location":"02-arq_geral/#componentes-de-software","text":"A arquitetura de software desenvolvida para o Risco Socioambiental pode ser observada na Figura abaixo. Fernanda, tem que fazer uma figura parecida com esta por\u00e9m atualizando o Openlayers para Leaflet e PostgreSQL para SQLite Essencialmente, pode-se dividir o Risco Socioambiental em tr\u00eas partes: Client: respons\u00e1vel por apresentar toda a interface, constru\u00eddo em Angular 5 com apoio dos frameworks: WebMap: Mapa interativo constru\u00eddo com o Leaflet Componentes front-end : Fernanda olhe aqui os componentes utilizados (Bootstrap..? ) ou foi tudo apenas com CSS puro? Server: Disponibiliza os servi\u00e7os que comp\u00f5em a aplica\u00e7\u00e3o: Application Server: Disponibiliza o acesso aos dados do Data Source, an\u00e1lises e configura\u00e7\u00f5es. OWS Server : Disponibiliza o acesso ao MapServer , respons\u00e1vel pelo processamento dos dados geogr\u00e1ficos, apresenta\u00e7\u00e3o visual dos mesmos e gerenciamento de cache das imagens geradas. Data Source : Respons\u00e1vel por armazenar os dados vetoriais e matriciais. Resumidamente, todos os dados usados pelo Risco Socioambiental est\u00e3o organizados em um banco de dados SQLite e em sistemas de arquivos (Data Repository) . O SQLite \u00e9 armazenado tamb\u00e9m em arquivo e permite processar consultas espaciais via Structured Query Language (SQL). J\u00e1 os dados que n\u00e3o necessitam de cruzamentos espaciais s\u00e3o armazenados em arquivos nos formatos Shapefile e/ou GeoTIFF. Estes dados s\u00e3o acessados pelo Application Server e pelo OWS Server (ambos constru\u00eddos em NodeJS) e s\u00e3o disponibilizados atrav\u00e9s de URLs com requisi\u00e7\u00f5es por meio do protocolo HTTP . Todas as requisi\u00e7\u00f5es Web realizadas aos Servers s\u00e3o interceptadas pelo Apache Server e devidamente redirecionadas. Desta forma, o Client realiza todas as requisi\u00e7\u00f5es necess\u00e1rias para construir a visualiza\u00e7\u00e3o dos elementos da p\u00e1gina, tais como: mapa interativo, gr\u00e1ficos, campo de busca e etc. Por fim, destaca-se que todo o c\u00f3digo-fonte para o Risco Socioambiental e tamb\u00e9m para o OWS Server foi disponibilizado publicamente no Github do LAPIG/UFG .","title":"Componentes de software"},{"location":"02-arq_servidor_de_aplicacao/","text":"Servidor de Aplica\u00e7\u00e3o Basicamente o Cerrado DPAT \u00e9 dividido em duas partes: o WebMap Client e o Application Server , conforme descrito anteriormente. O c\u00f3digo-fonte para estas duas partes est\u00e1 hospedado no resposit\u00f3rio Github do projeto. Dentro do reposit\u00f3rio do projeto, o c\u00f3digo-fonte do Application Server est\u00e1 em src/server . Por ser constru\u00eddo em NodeJS, ao clonar o projeto o usu\u00e1rio dever\u00e1 navegar at\u00e9 a pasta server e instalar as depend\u00eancias gerenciadas pelo Node Package Manager (NPM) atrav\u00e9s do comando: npm install Em seguida, deve-se copiar o arquivo .env.exemple renomeando-o para .env: cp .env.exemple .env Em seguida, deve-se alterar o arquivo .env com as devidas configura\u00e7\u00f5es e par\u00e2metros referentes ao banco de dados, pastas para armazenamento dos arquivos de Upload e Download e endere\u00e7o de hospedagem do OWS Server. Um exemplo de arquivo .env pode ser observado na se\u00e7\u00e3o Por fim, a fim de facilitar a execu\u00e7\u00e3o do Application Server foi desenvolvido um script nomeado start.sh localizado na raiz da pasta src/server . Portanto, basta realizar a execu\u00e7\u00e3o deste arquivo para inicializar o Application Server . A fim de identificar modifica\u00e7\u00f5es em tempo real, o Application Server faz uso da biblioteca always , portanto talvez seja necess\u00e1rio a instala\u00e7\u00e3o da mesma atrav\u00e9s do comando. $ sudo npm install always -g Ap\u00f3s a instala\u00e7\u00e3o do always , pode-se inicializar o Application Server atrav\u00e9s do comando: $ ./src/server/start.sh Manipula\u00e7\u00e3o do banco de dados Fernanda, vamos adicionar uam breve explica\u00e7\u00e3o de como configurar o banco de dados, caminho para o arquivo SQLITE e local no config.js que deve-se configurar","title":"Servidor de aplica\u00e7\u00e3o"},{"location":"02-arq_servidor_de_aplicacao/#servidor-de-aplicacao","text":"Basicamente o Cerrado DPAT \u00e9 dividido em duas partes: o WebMap Client e o Application Server , conforme descrito anteriormente. O c\u00f3digo-fonte para estas duas partes est\u00e1 hospedado no resposit\u00f3rio Github do projeto. Dentro do reposit\u00f3rio do projeto, o c\u00f3digo-fonte do Application Server est\u00e1 em src/server . Por ser constru\u00eddo em NodeJS, ao clonar o projeto o usu\u00e1rio dever\u00e1 navegar at\u00e9 a pasta server e instalar as depend\u00eancias gerenciadas pelo Node Package Manager (NPM) atrav\u00e9s do comando: npm install Em seguida, deve-se copiar o arquivo .env.exemple renomeando-o para .env: cp .env.exemple .env Em seguida, deve-se alterar o arquivo .env com as devidas configura\u00e7\u00f5es e par\u00e2metros referentes ao banco de dados, pastas para armazenamento dos arquivos de Upload e Download e endere\u00e7o de hospedagem do OWS Server. Um exemplo de arquivo .env pode ser observado na se\u00e7\u00e3o Por fim, a fim de facilitar a execu\u00e7\u00e3o do Application Server foi desenvolvido um script nomeado start.sh localizado na raiz da pasta src/server . Portanto, basta realizar a execu\u00e7\u00e3o deste arquivo para inicializar o Application Server . A fim de identificar modifica\u00e7\u00f5es em tempo real, o Application Server faz uso da biblioteca always , portanto talvez seja necess\u00e1rio a instala\u00e7\u00e3o da mesma atrav\u00e9s do comando. $ sudo npm install always -g Ap\u00f3s a instala\u00e7\u00e3o do always , pode-se inicializar o Application Server atrav\u00e9s do comando: $ ./src/server/start.sh","title":"Servidor de Aplica\u00e7\u00e3o"},{"location":"02-arq_servidor_de_aplicacao/#manipulacao-do-banco-de-dados","text":"Fernanda, vamos adicionar uam breve explica\u00e7\u00e3o de como configurar o banco de dados, caminho para o arquivo SQLITE e local no config.js que deve-se configurar","title":"Manipula\u00e7\u00e3o do banco de dados"},{"location":"02-arq_servidor_de_mapas/","text":"Servidor de Mapas O OWS Server \u00e9 respons\u00e1vel por encaminhar as requisi\u00e7\u00f5es ao Mapserver a fim de gerar a visualiza\u00e7\u00e3o dos dados geogr\u00e1ficos e organizar para que as imagens geradas sejam armazenadas em cache para melhorar o desempenho em requisi\u00e7\u00f5es futuras. O c\u00f3digo-fonte para o OWS Server se encontra no reposit\u00f3rio Github do LAPIG/UFG. Devido a facilidade em lidar com a arquitetura de WebServices, o c\u00f3digo em NodeJS foi criado para tamb\u00e9m realizar o controle de cache das imagens processadas pelo Mapserver. Para tal, uma customiza\u00e7\u00e3o foi criada a fim de se associar uma chave ( cacheKey ) a cada imagem de cada camada configurada no Mapserver. Esta imagem \u00e9 armazenada em um sistema de arquivos (pasta) chamada OWS-Cache , de modo que, em futuras requisi\u00e7\u00f5es para uma determinada imagem, \u00e9 verificada se a imagem j\u00e1 existe na OWS-Cache ou n\u00e3o. Caso exista, a imagem \u00e9 retornada na requisi\u00e7\u00e3o, caso n\u00e3o exista, o c\u00f3digo NodeJS envia a requisi\u00e7\u00e3o para o Mapserver processar e ger\u00e1-la, armazenando-a no OWS-Cache . O m\u00e9todo que realiza esta verifica\u00e7\u00e3o \u00e9 o m\u00e9todo OgcServer.ows que faz parte do Controlador da aplica\u00e7\u00e3o em NodeJS. src/controllers/ogc-server.js OgcServer.ows = function(request, response) { var params = Internal.getParams(request); response.setHeader( Access-Control-Allow-Origin , * ); Internal.setHeaders(params, request, response); var cacheKey = Internal.getCacheKey(params); if(cacheKey (config['cacheEnable'] || Internal.isWmsGetCap(params)) ) { Internal.doRequestWithCache(cacheKey, params, response); } else { Internal.doRequest(params, response); } } Esta customiza\u00e7\u00e3o pode ser encontrada no c\u00f3digo NodeJS no reposit\u00f3rio espec\u00edfico para o c\u00f3digo NodeJS no Github . A configura\u00e7\u00e3o da pasta onde ser\u00e3o gerados os caches \u00e9 feita no arquivo config.js na linha 41 atrav\u00e9s da vari\u00e1vel cacheDir . Servi\u00e7o de interoperabilidade A interoperabilidade \u00e9 uma tecnologia que possibilita o compartilhamento de dados entre sistemas, independente do local f\u00edsico de armazenamento e da tecnologia utilizada em cada servidor de dados. No Geoprocessamento, a interoperabilidade pode ser aplicada para promover o interc\u00e2mbio de dados geogr\u00e1ficos entre diferentes softwares de SIG. O OCG (Open Geospatial Consortium, Inc.) \u00e9 uma organiza\u00e7\u00e3o que tem como objetivo principal viabilizar o interc\u00e2mbio de dados geogr\u00e1ficos atrav\u00e9s da cria\u00e7\u00e3o de especifica\u00e7\u00f5es que simplificam a intera\u00e7\u00e3o entre diferentes fontes de dados. Desta forma, os principais servi\u00e7os especificados pela OGC s\u00e3o: Web Map Service - WMS : produz mapas din\u00e2micos partir de dados georreferenciados em um servidor remoto. Esses mapas s\u00e3o geralmente apresentados no formato de figura (PNG, JPEG ou GIF). Tamb\u00e9m \u00e9 poss\u00edvel consultar os atributos dos elementos que comp\u00f5em os mapas. Web Feature Service - WFS : define um servi\u00e7o para recupera\u00e7\u00e3o de objetos ( features ) espaciais. Diferentemente do WMS, o WFS devolve o dado e n\u00e3o uma \"figura\" do dado. Tile Map Service - TMS : define um servi\u00e7o que fornece imagens de dados geogr\u00e1ficos a partir de URLs para por\u00e7\u00f5es ( tiles ) definidas pelo conjunto de coordenadas {z} {x} {y} do dado georeferenciado. O TMS \u00e9 mais amplamente suportado pelos navegadores Web. UTFGrid : usam uma combina\u00e7\u00e3o de codifica\u00e7\u00e3o JSON e arquivos grid ASCII que est\u00e3o ao lado de cada bloco de imagem do mapa. Desta forma, uma tabela de pesquisa em JSON fornece o conjunto completo de atributos que viabiliza a devolu\u00e7\u00e3o de dados sobre aquele grid, permitindo interatividade com o mapas. Desta forma, uma representa\u00e7\u00e3o visual da interoperabilidade entre servi\u00e7os pode ser encontrada no link e apresentada abaixo. Por fim, a tabela abaixo apresenta os tipos de servi\u00e7os fornecidos pelo Risco Socioambiental bem como suas URLs de acesso, onde ows_host representa o dom\u00ednio onde o OWS Server est\u00e1 hospedado e layername representa a camada configurada no Mapfile: Tipo de Requisi\u00e7\u00e3o Fonte Descri\u00e7\u00e3o URL WMS OWS Server Retorna uma imagem com a legenda da camada ( layername ) especificada no mapfile .. https:// ows_host /ows?TRANSPARENT=TRUE VERSION=1.1.1 SERVICE=WMS REQUEST=GetLegendGraphic layer= layername format=image/png WMS OWS Server Retorna uma imagem com a composi\u00e7\u00e3o de camadas identificadas pelas layers, com o foco no enquadramento para a geometria definida pela fun\u00e7\u00e3o ST_EXTENT do Postgis. Por fim, o par\u00e2metro sql_applied_on_MSFILTER especifica a query que dever\u00e1 ser aplicada para filtrar dados em todas as camadas que possuam MSFILTER em sua configura\u00e7\u00e3o no Mapserver. https:// ows_host /ows?SERVICE=WMS REQUEST=GetMap VERSION=1.1.1 layers= layername1 , layername2 , ... bbox= bounding_box TRANSPARENT=TRUE srs=EPSG:4674 width=768 height=768 format=image/png styles= ENHANCE=TRUE MSFILTER= sql_applied_on_MSFILTER TMS OWS Server Retorna uma imagem com a composi\u00e7\u00e3o de camadas identificadas pelas layers, com o foco no enquadramento para a geometria definida pela fun\u00e7\u00e3o ST_EXTENT do Postgis. Por fim, o par\u00e2metro sql_applied_on_MSFILTER especifica a query que dever\u00e1 ser aplicada para filtrar dados em todas as camadas que possuam MSFILTER em sua configura\u00e7\u00e3o no Mapserver. https:// ows_host /ows?layers= layername MSFILTER= sql_applied_on_MSFILTER mode=tile tile= {z} + {x} + {y} tilemode=gmap map.imagetype=png TMS Mapbox Retorna a composi\u00e7\u00e3o do mapa Geopol\u00edtico fornecido pela Mapbox https://api.tiles.mapbox.com/v4/mapbox.light/ {z} / {x} / {y} .png?access_token= chave_de_acesso . TMS Google Maps Retorna a composi\u00e7\u00e3o de imagens do mapa fornecido pela API do GoogleMaps. https://mt{0-3}.google.com/vt/lyrs=m x= {x} y= {y} z= {z} TMS World Shaded Relief Retorna a composi\u00e7\u00e3o de mapas de Relevo fornecido pelo ArcGis. https://server.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/ {z} / {y} / {x} UTFGrid OWS Server Retorna os dados referentes aos atributos definidos na camada fornecida pelo OWS Server para o especificado na requisi\u00e7\u00e3o para o tile {z},{x},{y}. https:// ows_host /ows?layers= layername MSFILTER= sql_applied_on_MSFILTER mode=tile tile= {z} + {x} + {y} tilemode=gmap map.imagetype=utfgrid Processo de atualiza\u00e7\u00e3o Um dado geogr\u00e1fico \u00e9 disponbilizado pelo Mapserver como uma camada. Assim como abordado na se\u00e7\u00e3o de servi\u00e7os de interoperabilidade os dados devem estar armazenados em uma pasta de cat\u00e1logo dos dados (pasta catalog) configur\u00e1vel no arquivo config.js atrav\u00e9s da vari\u00e1vel cacheDir . O Mapserver utiliza um arquivo de configura\u00e7\u00e3o para renderiza\u00e7\u00e3o de dados geoespaciais chamado de Mapfile. O principal objetivo do Mapfile \u00e9 definir as camadas que podem ser \"desenhadas\" pelo Mapserver, como ler estes dados (uma vez que eles podem ser vetores ou matrizes) e como renderiz\u00e1-los, definindo cores, s\u00edmbolos, r\u00f3tulos, legendas e etc. Desta forma, o Mapfile inclui informa\u00e7\u00f5es sobre: Quais camadas devem ser renderizadas; Onde est\u00e1 o foco geogr\u00e1fico do mapa; Qual proje\u00e7\u00e3o est\u00e1 sendo usada; Qual o formato gr\u00e1fico de sa\u00edda; Configura\u00e7\u00e3o da legenda e a escala utilizada; As duas figuras abaixo apresentam exemplos do Mapfile da camada de \u00c1rea Plantada de Milho como exemplo de mapfile para dados vetoriais e matriciais respectivamente, ambos presentes na plataforma Risco Socioambiental. Portanto, segue a especifica\u00e7\u00e3o de cada item destacado na imagem: Apresenta o nome da camada (NAME), bem como a fonte de onde este dado ser\u00e1 carregado (CONNECTION). No exemplo este dado \u00e9 acessado pela comunica\u00e7\u00e3o com o SQLite. Al\u00e9m deste, temos tamb\u00e9m o par\u00e2metro EXTENT que ir\u00e1 informar a extens\u00e3o em que o dado se encontra, no exemplo abaixo foi definida a extens\u00e3o de todo o Brasil. Apresenta os metadados e a proje\u00e7\u00e3o utilizada na camada; Apresenta o par\u00e2metro FILTER (MSFILTER) que ir\u00e1 receber a filtragem aplicada ao dado por meio do runtime substitution ; Define uma classifica\u00e7\u00e3o para os dados a fim de customizar a colora\u00e7\u00e3o de acordo com um crit\u00e9rio. A classifica\u00e7\u00e3o estabelecida tamb\u00e9m ir\u00e1 compor a legenda. No exemplo, \u00e9 aplicada as cores cinza (preenchimento) e azul (bordas). Um segundo tipo de camada de dados poss\u00edvel de ser incorporada ao Risco Socioambiental \u00e9 oriunda de dados matriciais, ou seja, imagens TIF. Para este tipo de dados, basta informar a localiza\u00e7\u00e3o do arquivo TIF e o crit\u00e9rio para classifica\u00e7\u00e3o se d\u00e1 de acordo com o valor do pixel em um ponto. Portanto, um exemplo para cria\u00e7\u00e3o de um Mapfile para arquivos matriciais se d\u00e1 conforme imagem abaixo. Por fim, o Mapfile utilizado para disponibilizar todas as camadas presentes no Risco Socioambiental est\u00e1 na pasta compartilhada do projeto no link . Disponibiliza\u00e7\u00e3o da camada no Application Server Fernanda, citar aqui o passo a passo necess\u00e1rio para disponibilizar uma camada no Front-end da aplica\u00e7\u00e3o.","title":"Servidor de mapas"},{"location":"02-arq_servidor_de_mapas/#servidor-de-mapas","text":"O OWS Server \u00e9 respons\u00e1vel por encaminhar as requisi\u00e7\u00f5es ao Mapserver a fim de gerar a visualiza\u00e7\u00e3o dos dados geogr\u00e1ficos e organizar para que as imagens geradas sejam armazenadas em cache para melhorar o desempenho em requisi\u00e7\u00f5es futuras. O c\u00f3digo-fonte para o OWS Server se encontra no reposit\u00f3rio Github do LAPIG/UFG. Devido a facilidade em lidar com a arquitetura de WebServices, o c\u00f3digo em NodeJS foi criado para tamb\u00e9m realizar o controle de cache das imagens processadas pelo Mapserver. Para tal, uma customiza\u00e7\u00e3o foi criada a fim de se associar uma chave ( cacheKey ) a cada imagem de cada camada configurada no Mapserver. Esta imagem \u00e9 armazenada em um sistema de arquivos (pasta) chamada OWS-Cache , de modo que, em futuras requisi\u00e7\u00f5es para uma determinada imagem, \u00e9 verificada se a imagem j\u00e1 existe na OWS-Cache ou n\u00e3o. Caso exista, a imagem \u00e9 retornada na requisi\u00e7\u00e3o, caso n\u00e3o exista, o c\u00f3digo NodeJS envia a requisi\u00e7\u00e3o para o Mapserver processar e ger\u00e1-la, armazenando-a no OWS-Cache . O m\u00e9todo que realiza esta verifica\u00e7\u00e3o \u00e9 o m\u00e9todo OgcServer.ows que faz parte do Controlador da aplica\u00e7\u00e3o em NodeJS. src/controllers/ogc-server.js OgcServer.ows = function(request, response) { var params = Internal.getParams(request); response.setHeader( Access-Control-Allow-Origin , * ); Internal.setHeaders(params, request, response); var cacheKey = Internal.getCacheKey(params); if(cacheKey (config['cacheEnable'] || Internal.isWmsGetCap(params)) ) { Internal.doRequestWithCache(cacheKey, params, response); } else { Internal.doRequest(params, response); } } Esta customiza\u00e7\u00e3o pode ser encontrada no c\u00f3digo NodeJS no reposit\u00f3rio espec\u00edfico para o c\u00f3digo NodeJS no Github . A configura\u00e7\u00e3o da pasta onde ser\u00e3o gerados os caches \u00e9 feita no arquivo config.js na linha 41 atrav\u00e9s da vari\u00e1vel cacheDir .","title":"Servidor de Mapas"},{"location":"02-arq_servidor_de_mapas/#servico-de-interoperabilidade","text":"A interoperabilidade \u00e9 uma tecnologia que possibilita o compartilhamento de dados entre sistemas, independente do local f\u00edsico de armazenamento e da tecnologia utilizada em cada servidor de dados. No Geoprocessamento, a interoperabilidade pode ser aplicada para promover o interc\u00e2mbio de dados geogr\u00e1ficos entre diferentes softwares de SIG. O OCG (Open Geospatial Consortium, Inc.) \u00e9 uma organiza\u00e7\u00e3o que tem como objetivo principal viabilizar o interc\u00e2mbio de dados geogr\u00e1ficos atrav\u00e9s da cria\u00e7\u00e3o de especifica\u00e7\u00f5es que simplificam a intera\u00e7\u00e3o entre diferentes fontes de dados. Desta forma, os principais servi\u00e7os especificados pela OGC s\u00e3o: Web Map Service - WMS : produz mapas din\u00e2micos partir de dados georreferenciados em um servidor remoto. Esses mapas s\u00e3o geralmente apresentados no formato de figura (PNG, JPEG ou GIF). Tamb\u00e9m \u00e9 poss\u00edvel consultar os atributos dos elementos que comp\u00f5em os mapas. Web Feature Service - WFS : define um servi\u00e7o para recupera\u00e7\u00e3o de objetos ( features ) espaciais. Diferentemente do WMS, o WFS devolve o dado e n\u00e3o uma \"figura\" do dado. Tile Map Service - TMS : define um servi\u00e7o que fornece imagens de dados geogr\u00e1ficos a partir de URLs para por\u00e7\u00f5es ( tiles ) definidas pelo conjunto de coordenadas {z} {x} {y} do dado georeferenciado. O TMS \u00e9 mais amplamente suportado pelos navegadores Web. UTFGrid : usam uma combina\u00e7\u00e3o de codifica\u00e7\u00e3o JSON e arquivos grid ASCII que est\u00e3o ao lado de cada bloco de imagem do mapa. Desta forma, uma tabela de pesquisa em JSON fornece o conjunto completo de atributos que viabiliza a devolu\u00e7\u00e3o de dados sobre aquele grid, permitindo interatividade com o mapas. Desta forma, uma representa\u00e7\u00e3o visual da interoperabilidade entre servi\u00e7os pode ser encontrada no link e apresentada abaixo. Por fim, a tabela abaixo apresenta os tipos de servi\u00e7os fornecidos pelo Risco Socioambiental bem como suas URLs de acesso, onde ows_host representa o dom\u00ednio onde o OWS Server est\u00e1 hospedado e layername representa a camada configurada no Mapfile: Tipo de Requisi\u00e7\u00e3o Fonte Descri\u00e7\u00e3o URL WMS OWS Server Retorna uma imagem com a legenda da camada ( layername ) especificada no mapfile .. https:// ows_host /ows?TRANSPARENT=TRUE VERSION=1.1.1 SERVICE=WMS REQUEST=GetLegendGraphic layer= layername format=image/png WMS OWS Server Retorna uma imagem com a composi\u00e7\u00e3o de camadas identificadas pelas layers, com o foco no enquadramento para a geometria definida pela fun\u00e7\u00e3o ST_EXTENT do Postgis. Por fim, o par\u00e2metro sql_applied_on_MSFILTER especifica a query que dever\u00e1 ser aplicada para filtrar dados em todas as camadas que possuam MSFILTER em sua configura\u00e7\u00e3o no Mapserver. https:// ows_host /ows?SERVICE=WMS REQUEST=GetMap VERSION=1.1.1 layers= layername1 , layername2 , ... bbox= bounding_box TRANSPARENT=TRUE srs=EPSG:4674 width=768 height=768 format=image/png styles= ENHANCE=TRUE MSFILTER= sql_applied_on_MSFILTER TMS OWS Server Retorna uma imagem com a composi\u00e7\u00e3o de camadas identificadas pelas layers, com o foco no enquadramento para a geometria definida pela fun\u00e7\u00e3o ST_EXTENT do Postgis. Por fim, o par\u00e2metro sql_applied_on_MSFILTER especifica a query que dever\u00e1 ser aplicada para filtrar dados em todas as camadas que possuam MSFILTER em sua configura\u00e7\u00e3o no Mapserver. https:// ows_host /ows?layers= layername MSFILTER= sql_applied_on_MSFILTER mode=tile tile= {z} + {x} + {y} tilemode=gmap map.imagetype=png TMS Mapbox Retorna a composi\u00e7\u00e3o do mapa Geopol\u00edtico fornecido pela Mapbox https://api.tiles.mapbox.com/v4/mapbox.light/ {z} / {x} / {y} .png?access_token= chave_de_acesso . TMS Google Maps Retorna a composi\u00e7\u00e3o de imagens do mapa fornecido pela API do GoogleMaps. https://mt{0-3}.google.com/vt/lyrs=m x= {x} y= {y} z= {z} TMS World Shaded Relief Retorna a composi\u00e7\u00e3o de mapas de Relevo fornecido pelo ArcGis. https://server.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/ {z} / {y} / {x} UTFGrid OWS Server Retorna os dados referentes aos atributos definidos na camada fornecida pelo OWS Server para o especificado na requisi\u00e7\u00e3o para o tile {z},{x},{y}. https:// ows_host /ows?layers= layername MSFILTER= sql_applied_on_MSFILTER mode=tile tile= {z} + {x} + {y} tilemode=gmap map.imagetype=utfgrid","title":"Servi\u00e7o de interoperabilidade"},{"location":"02-arq_servidor_de_mapas/#processo-de-atualizacao","text":"Um dado geogr\u00e1fico \u00e9 disponbilizado pelo Mapserver como uma camada. Assim como abordado na se\u00e7\u00e3o de servi\u00e7os de interoperabilidade os dados devem estar armazenados em uma pasta de cat\u00e1logo dos dados (pasta catalog) configur\u00e1vel no arquivo config.js atrav\u00e9s da vari\u00e1vel cacheDir . O Mapserver utiliza um arquivo de configura\u00e7\u00e3o para renderiza\u00e7\u00e3o de dados geoespaciais chamado de Mapfile. O principal objetivo do Mapfile \u00e9 definir as camadas que podem ser \"desenhadas\" pelo Mapserver, como ler estes dados (uma vez que eles podem ser vetores ou matrizes) e como renderiz\u00e1-los, definindo cores, s\u00edmbolos, r\u00f3tulos, legendas e etc. Desta forma, o Mapfile inclui informa\u00e7\u00f5es sobre: Quais camadas devem ser renderizadas; Onde est\u00e1 o foco geogr\u00e1fico do mapa; Qual proje\u00e7\u00e3o est\u00e1 sendo usada; Qual o formato gr\u00e1fico de sa\u00edda; Configura\u00e7\u00e3o da legenda e a escala utilizada; As duas figuras abaixo apresentam exemplos do Mapfile da camada de \u00c1rea Plantada de Milho como exemplo de mapfile para dados vetoriais e matriciais respectivamente, ambos presentes na plataforma Risco Socioambiental. Portanto, segue a especifica\u00e7\u00e3o de cada item destacado na imagem: Apresenta o nome da camada (NAME), bem como a fonte de onde este dado ser\u00e1 carregado (CONNECTION). No exemplo este dado \u00e9 acessado pela comunica\u00e7\u00e3o com o SQLite. Al\u00e9m deste, temos tamb\u00e9m o par\u00e2metro EXTENT que ir\u00e1 informar a extens\u00e3o em que o dado se encontra, no exemplo abaixo foi definida a extens\u00e3o de todo o Brasil. Apresenta os metadados e a proje\u00e7\u00e3o utilizada na camada; Apresenta o par\u00e2metro FILTER (MSFILTER) que ir\u00e1 receber a filtragem aplicada ao dado por meio do runtime substitution ; Define uma classifica\u00e7\u00e3o para os dados a fim de customizar a colora\u00e7\u00e3o de acordo com um crit\u00e9rio. A classifica\u00e7\u00e3o estabelecida tamb\u00e9m ir\u00e1 compor a legenda. No exemplo, \u00e9 aplicada as cores cinza (preenchimento) e azul (bordas). Um segundo tipo de camada de dados poss\u00edvel de ser incorporada ao Risco Socioambiental \u00e9 oriunda de dados matriciais, ou seja, imagens TIF. Para este tipo de dados, basta informar a localiza\u00e7\u00e3o do arquivo TIF e o crit\u00e9rio para classifica\u00e7\u00e3o se d\u00e1 de acordo com o valor do pixel em um ponto. Portanto, um exemplo para cria\u00e7\u00e3o de um Mapfile para arquivos matriciais se d\u00e1 conforme imagem abaixo. Por fim, o Mapfile utilizado para disponibilizar todas as camadas presentes no Risco Socioambiental est\u00e1 na pasta compartilhada do projeto no link .","title":"Processo de atualiza\u00e7\u00e3o"},{"location":"02-arq_servidor_de_mapas/#disponibilizacao-da-camada-no-application-server","text":"Fernanda, citar aqui o passo a passo necess\u00e1rio para disponibilizar uma camada no Front-end da aplica\u00e7\u00e3o.","title":"Disponibiliza\u00e7\u00e3o da camada no Application Server"},{"location":"03-dad_rasters/","text":"Dados Rasters Os dados Rasters s\u00e3o imagens com informa\u00e7\u00f5es geogr\u00e1ficas e est\u00e3o armazenados no sistema de arquivos do servidor. A configura\u00e7\u00e3o da pasta do local de armazenamento destes arquivos \u00e9 feita no OWS Server na linha 54 do arquivo config.js , atrav\u00e9s da vari\u00e1vel config['path_catalog'] . Esta configura\u00e7\u00e3o dever\u00e1 apresentar a pasta com o cat\u00e1logo de dados a serem disponibilizados no OWS Server. Estrutura de diret\u00f3rios Todos os dados geogr\u00e1ficos Raster do projeto podem ser encontrados no link . Ap\u00f3s a descompacta\u00e7\u00e3o do arquivo DADOS_RASTER_CATALOG_FIP_CERRADO.tar.gz os dados est\u00e3o armazenados em diferentes subpastas. Considerando os dados catalogados na se\u00e7\u00e3o Dados Geogr\u00e1ficos e o diret\u00f3rio configurado no config.js temos os seguintes dados em formato raster: Dado Nome do arquivo Subpasta Susceptibilidade a Desmatamentos Grandes bi_ce_susceptibilidade_desmatamento_maiores_100_na_lapig.tif /FIP Susceptibilidade a Desmatamentos Pequenos bi_ce_susceptibilidade_desmatamento_menores_100_na_lapig.tif /FIP Altitude bi_ce_srtm_altitude_30_2000_lapig.tif /Relevo Declividade bi_ce_srtm_declividade_30_2000_lapig.tif /Relevo M\u00e9dia da Precipita\u00e7\u00e3o Acumulada bi_ce_precipitacao_historica_30_lapig.tif /\u00c1gua Mosaico Landsat 2000-2019 bi_ce_mosaico_landsat_completo_30_2000_fip.tif bi_ce_mosaico_landsat_completo_30_2002_fip.tif bi_ce_mosaico_landsat_completo_30_2004_fip.tif bi_ce_mosaico_landsat_completo_30_2006_fip.tif bi_ce_mosaico_landsat_completo_30_2008_fip.tif bi_ce_mosaico_landsat_completo_30_2010_fip.tif bi_ce_mosaico_landsat_completo_30_2012_fip.tif bi_ce_mosaico_landsat_completo_30_2013_fip.tif bi_ce_mosaico_landsat_completo_30_2014_fip.tif bi_ce_mosaico_landsat_completo_30_2015_fip.tif bi_ce_mosaico_landsat_completo_30_2016_fip.tif bi_ce_mosaico_landsat_completo_30_2017_fip.tif bi_ce_mosaico_landsat_completo_30_2018_fip.tif bi_ce_mosaico_landsat_completo_30_2019_fip.tif /img_satelites/bi_ce_mosaico_landsat_30_fip Mosaico Sentinel 2016-2019 bi_ce_mosaico_sentinel_10_2016_lapig.tif bi_ce_mosaico_sentinel_10_2017_lapig.tif bi_ce_mosaico_sentinel_10_2018_lapig.tif bi_ce_mosaico_sentinel_10_2019_lapig.tif /img_satelites/bi_ce_mosaico_sentinel_10_lapig Processo de atualiza\u00e7\u00e3o Mosaicos Landsat Os mosaicos Landsat disponibilizados para visualiza\u00e7\u00e3o no Cerrado DPAT s\u00e3o os mesmos utilizados pelo INPE para inspe\u00e7\u00e3o visual e detec\u00e7\u00e3o das \u00e1reas desmatadas pelo sistema PRODES-Cerrado. Tais imagens podem ser baixadas pelo portal Earth Explorer de acordo com a data e a \u00f3rbita-ponto presentes no arqivo shapefile disponibilizado pelo INPE no portal Terrabrasilis . Ap\u00f3s o download do arquivo compactado correspondente a cada imagem, devem ser criadas composi\u00e7\u00f5es multibandas com as bandas do vermelho, infravermelho, e infravermelho de ondas curtas. Uma outra forma mais simples para a obten\u00e7\u00e3o destas imagens \u00e9 o contato direto com a equipe do LAPIG atrav\u00e9s do e-mail cerradodpat.lapig@ufg.br. Com as imagens devidamente armazenadas, dois scripts correspondentes ao recorte do limite util da cena e a cria\u00e7\u00e3o do mosaico das imagens de cada ano s\u00e3o executados simultaneamente por meio da execu\u00e7\u00e3o do arquivo run.sh , que ir\u00e1 chamar o arquivo clip_landsat.sh . No arquivo run.shp \u00e9 necess\u00e1rio que se edite as seguintes linhas: INPUT_DIR=\"\" Diret\u00f3rio \"raiz\" para as cenas isoladas de cada ano (linha 3). OUTPUT_DIR=\"\" Diret\u00f3rio de sa\u00edda com os mosaicos de cada ano (linha 4). DIRS=\"\" Diret\u00f3rios com os anos a serem mosaicados. (linha 5) No arquivo clip_landsat.sh, a edi\u00e7\u00e3o \u00e9 feita na seguinte linha: INPUT_GRID=\"\" Arquivo no formato shapefile com os limites das cenas Landsat. (linha 10) Ap\u00f3s as edi\u00e7\u00f5es deve-se executar o seguinte comando: sh run.sh As imagens no formato TIF de cada ano estar\u00e3o disponiveis na pasta apontada em OUTPUT_DIR . Mosaicos Sentinel-2 As imagens Sentinel-2 foram baixadas por meio da plataforma Google Earth Engine . Devido a caracteristica sazonal do bioma Cerrado, um mesmo alvo pode apresentar diferentes respostas espectrais durante os diferentes meses do ano. Assim, para que o mosaico apresentasse um padr\u00e3o mais homog\u00eaneo entre as cenas, buscou-se por imagens dentro de um curto periodo de tempo. Foram priorizadas imagens para o periodo de um m\u00eas. No caso da indisponibilidade de imagens sem nuvens, o periodo foi estendido at\u00e9 que o intervalo entre maio e outubro fosse alcan\u00e7ado. Destaca-se tamb\u00e9m que diferentes padr\u00f5es clim\u00e1ticos podem ser encontrado no bioma, dificultando assim a identifica\u00e7\u00e3o de imagens sem nuvens. Dessa forma, diferentes geometrias foram criadas para a sele\u00e7\u00e3o de imagens em regi\u00f5es espec\u00edficas (ex: norte do bioma, pr\u00f3ximo ao litoral maranhense). O c\u00f3digo para o download do mosaico Sentinel-2 encontra-se disponivel para acesso . Devido ao limite de tamanho o mosaico baixado \u00e9 dividido em tiles. A jun\u00e7\u00e3o dos tiles em um \u00fanico arquivo \u00e9 feita a partir dos comandos gdalbuildvrt e gdal_translate presentes no pacote GDAL . gdalbuildvrt mosaic_ $ano .vrt mosaic_ $ano * -srcnodata 0 -vrtnodata 0 gdal_translate mosaic_ $ano .vrt mosaic_ $ano .tif -co COMPRESS=LZW -co BIGTIFF=YES -co TILED=YES -a_nodata 0 Onde $ano \u00e9 o ano de cada mosaico, presente no nome dos tiles correspondentes a imagem baixada. Disponibiliza\u00e7\u00e3o no OWS Server Ap\u00f3s a cria\u00e7\u00e3o dos arquivos \u00fanicos para os mosaicos Landsat e Sentinel, antes de disponibilizar o mosaico ao OWS Server \u00e9 necess\u00e1rio a cria\u00e7\u00e3o das pir\u00e2mides para n\u00edveis diferentes de visualiza\u00e7\u00e3o do mosaico. Para criar a visualiza\u00e7\u00e3o em n\u00edveis, execute o comando: gdaladdo --config USE_RRD=YES -ro nome_arquivo.tif 2 4 8 Ao finalizar o processamento, \u00e9 importante definir o valor das bandas para a colora\u00e7\u00e3o do mosaico, o que pode ser alcan\u00e7ado com o apoio do QGIS, ao clicar com o bot\u00e3o direito sobre a camada - propriedades - simbologia na op\u00e7\u00e3o.A imagem abaixo apresenta um exemplo de defini\u00e7\u00e3o do valor das bandas aplicadas ao mosaico Sentinel de 2018. Por fim, pode-se ent\u00e3o disponibilizar o mosaico como camada no Mapserver atrav\u00e9s de um mapfile . Um exemplo de mapfile para cria\u00e7\u00e3o da camada com o mosaico Sentinel de 2018 pode ser visualizada abaixo: LAYER NAME bi_ce_mosaico_sentinel_10_2018_lapig DATA img_satelites/bi_ce_mosaico_sentinel_10_lapig/bi_ce_mosaico_sentinel_10_2018_lapig.tif EXTENT -60.1094198 -24.6846260 -41.5220189 -2.3262773 METADATA ows_title Mosaico Sentinel do Bioma Cerrado ows_abstract A gera\u00e7\u00e3o dos mosaicos considerou, para cada cena e ano, a melhor imagem (i.e. com a menor cobertura de nuvens) adquirida no per\u00edodo de junho \u00e0 setembro. gml_exclude_items the_geom gml_include_items all gml_geometries the_geom END PROJECTION init=epsg:4674 END STATUS ON TYPE Raster TEMPLATE DUMMY OFFSITE 0 0 0 PROCESSING SCALE_1=748,1405 PROCESSING SCALE_2=613,1534 PROCESSING SCALE_3=385,2134 PROCESSING BANDS=3,2,1 END \u00c9 importante ressaltar a inser\u00e7\u00e3o do par\u00e2metro PROCESSING \"SCALE_\" ao Mapfile permitindo informar ao Mapserver os valores de bandas definidos anteriormente.","title":"Rasters"},{"location":"03-dad_rasters/#dados-rasters","text":"Os dados Rasters s\u00e3o imagens com informa\u00e7\u00f5es geogr\u00e1ficas e est\u00e3o armazenados no sistema de arquivos do servidor. A configura\u00e7\u00e3o da pasta do local de armazenamento destes arquivos \u00e9 feita no OWS Server na linha 54 do arquivo config.js , atrav\u00e9s da vari\u00e1vel config['path_catalog'] . Esta configura\u00e7\u00e3o dever\u00e1 apresentar a pasta com o cat\u00e1logo de dados a serem disponibilizados no OWS Server.","title":"Dados Rasters"},{"location":"03-dad_rasters/#estrutura-de-diretorios","text":"Todos os dados geogr\u00e1ficos Raster do projeto podem ser encontrados no link . Ap\u00f3s a descompacta\u00e7\u00e3o do arquivo DADOS_RASTER_CATALOG_FIP_CERRADO.tar.gz os dados est\u00e3o armazenados em diferentes subpastas. Considerando os dados catalogados na se\u00e7\u00e3o Dados Geogr\u00e1ficos e o diret\u00f3rio configurado no config.js temos os seguintes dados em formato raster: Dado Nome do arquivo Subpasta Susceptibilidade a Desmatamentos Grandes bi_ce_susceptibilidade_desmatamento_maiores_100_na_lapig.tif /FIP Susceptibilidade a Desmatamentos Pequenos bi_ce_susceptibilidade_desmatamento_menores_100_na_lapig.tif /FIP Altitude bi_ce_srtm_altitude_30_2000_lapig.tif /Relevo Declividade bi_ce_srtm_declividade_30_2000_lapig.tif /Relevo M\u00e9dia da Precipita\u00e7\u00e3o Acumulada bi_ce_precipitacao_historica_30_lapig.tif /\u00c1gua Mosaico Landsat 2000-2019 bi_ce_mosaico_landsat_completo_30_2000_fip.tif bi_ce_mosaico_landsat_completo_30_2002_fip.tif bi_ce_mosaico_landsat_completo_30_2004_fip.tif bi_ce_mosaico_landsat_completo_30_2006_fip.tif bi_ce_mosaico_landsat_completo_30_2008_fip.tif bi_ce_mosaico_landsat_completo_30_2010_fip.tif bi_ce_mosaico_landsat_completo_30_2012_fip.tif bi_ce_mosaico_landsat_completo_30_2013_fip.tif bi_ce_mosaico_landsat_completo_30_2014_fip.tif bi_ce_mosaico_landsat_completo_30_2015_fip.tif bi_ce_mosaico_landsat_completo_30_2016_fip.tif bi_ce_mosaico_landsat_completo_30_2017_fip.tif bi_ce_mosaico_landsat_completo_30_2018_fip.tif bi_ce_mosaico_landsat_completo_30_2019_fip.tif /img_satelites/bi_ce_mosaico_landsat_30_fip Mosaico Sentinel 2016-2019 bi_ce_mosaico_sentinel_10_2016_lapig.tif bi_ce_mosaico_sentinel_10_2017_lapig.tif bi_ce_mosaico_sentinel_10_2018_lapig.tif bi_ce_mosaico_sentinel_10_2019_lapig.tif /img_satelites/bi_ce_mosaico_sentinel_10_lapig","title":"Estrutura de diret\u00f3rios"},{"location":"03-dad_rasters/#processo-de-atualizacao","text":"","title":"Processo de atualiza\u00e7\u00e3o"},{"location":"03-dad_rasters/#mosaicos-landsat","text":"Os mosaicos Landsat disponibilizados para visualiza\u00e7\u00e3o no Cerrado DPAT s\u00e3o os mesmos utilizados pelo INPE para inspe\u00e7\u00e3o visual e detec\u00e7\u00e3o das \u00e1reas desmatadas pelo sistema PRODES-Cerrado. Tais imagens podem ser baixadas pelo portal Earth Explorer de acordo com a data e a \u00f3rbita-ponto presentes no arqivo shapefile disponibilizado pelo INPE no portal Terrabrasilis . Ap\u00f3s o download do arquivo compactado correspondente a cada imagem, devem ser criadas composi\u00e7\u00f5es multibandas com as bandas do vermelho, infravermelho, e infravermelho de ondas curtas. Uma outra forma mais simples para a obten\u00e7\u00e3o destas imagens \u00e9 o contato direto com a equipe do LAPIG atrav\u00e9s do e-mail cerradodpat.lapig@ufg.br. Com as imagens devidamente armazenadas, dois scripts correspondentes ao recorte do limite util da cena e a cria\u00e7\u00e3o do mosaico das imagens de cada ano s\u00e3o executados simultaneamente por meio da execu\u00e7\u00e3o do arquivo run.sh , que ir\u00e1 chamar o arquivo clip_landsat.sh . No arquivo run.shp \u00e9 necess\u00e1rio que se edite as seguintes linhas: INPUT_DIR=\"\" Diret\u00f3rio \"raiz\" para as cenas isoladas de cada ano (linha 3). OUTPUT_DIR=\"\" Diret\u00f3rio de sa\u00edda com os mosaicos de cada ano (linha 4). DIRS=\"\" Diret\u00f3rios com os anos a serem mosaicados. (linha 5) No arquivo clip_landsat.sh, a edi\u00e7\u00e3o \u00e9 feita na seguinte linha: INPUT_GRID=\"\" Arquivo no formato shapefile com os limites das cenas Landsat. (linha 10) Ap\u00f3s as edi\u00e7\u00f5es deve-se executar o seguinte comando: sh run.sh As imagens no formato TIF de cada ano estar\u00e3o disponiveis na pasta apontada em OUTPUT_DIR .","title":"Mosaicos Landsat"},{"location":"03-dad_rasters/#mosaicos-sentinel-2","text":"As imagens Sentinel-2 foram baixadas por meio da plataforma Google Earth Engine . Devido a caracteristica sazonal do bioma Cerrado, um mesmo alvo pode apresentar diferentes respostas espectrais durante os diferentes meses do ano. Assim, para que o mosaico apresentasse um padr\u00e3o mais homog\u00eaneo entre as cenas, buscou-se por imagens dentro de um curto periodo de tempo. Foram priorizadas imagens para o periodo de um m\u00eas. No caso da indisponibilidade de imagens sem nuvens, o periodo foi estendido at\u00e9 que o intervalo entre maio e outubro fosse alcan\u00e7ado. Destaca-se tamb\u00e9m que diferentes padr\u00f5es clim\u00e1ticos podem ser encontrado no bioma, dificultando assim a identifica\u00e7\u00e3o de imagens sem nuvens. Dessa forma, diferentes geometrias foram criadas para a sele\u00e7\u00e3o de imagens em regi\u00f5es espec\u00edficas (ex: norte do bioma, pr\u00f3ximo ao litoral maranhense). O c\u00f3digo para o download do mosaico Sentinel-2 encontra-se disponivel para acesso . Devido ao limite de tamanho o mosaico baixado \u00e9 dividido em tiles. A jun\u00e7\u00e3o dos tiles em um \u00fanico arquivo \u00e9 feita a partir dos comandos gdalbuildvrt e gdal_translate presentes no pacote GDAL . gdalbuildvrt mosaic_ $ano .vrt mosaic_ $ano * -srcnodata 0 -vrtnodata 0 gdal_translate mosaic_ $ano .vrt mosaic_ $ano .tif -co COMPRESS=LZW -co BIGTIFF=YES -co TILED=YES -a_nodata 0 Onde $ano \u00e9 o ano de cada mosaico, presente no nome dos tiles correspondentes a imagem baixada.","title":"Mosaicos Sentinel-2"},{"location":"03-dad_rasters/#disponibilizacao-no-ows-server","text":"Ap\u00f3s a cria\u00e7\u00e3o dos arquivos \u00fanicos para os mosaicos Landsat e Sentinel, antes de disponibilizar o mosaico ao OWS Server \u00e9 necess\u00e1rio a cria\u00e7\u00e3o das pir\u00e2mides para n\u00edveis diferentes de visualiza\u00e7\u00e3o do mosaico. Para criar a visualiza\u00e7\u00e3o em n\u00edveis, execute o comando: gdaladdo --config USE_RRD=YES -ro nome_arquivo.tif 2 4 8 Ao finalizar o processamento, \u00e9 importante definir o valor das bandas para a colora\u00e7\u00e3o do mosaico, o que pode ser alcan\u00e7ado com o apoio do QGIS, ao clicar com o bot\u00e3o direito sobre a camada - propriedades - simbologia na op\u00e7\u00e3o.A imagem abaixo apresenta um exemplo de defini\u00e7\u00e3o do valor das bandas aplicadas ao mosaico Sentinel de 2018. Por fim, pode-se ent\u00e3o disponibilizar o mosaico como camada no Mapserver atrav\u00e9s de um mapfile . Um exemplo de mapfile para cria\u00e7\u00e3o da camada com o mosaico Sentinel de 2018 pode ser visualizada abaixo: LAYER NAME bi_ce_mosaico_sentinel_10_2018_lapig DATA img_satelites/bi_ce_mosaico_sentinel_10_lapig/bi_ce_mosaico_sentinel_10_2018_lapig.tif EXTENT -60.1094198 -24.6846260 -41.5220189 -2.3262773 METADATA ows_title Mosaico Sentinel do Bioma Cerrado ows_abstract A gera\u00e7\u00e3o dos mosaicos considerou, para cada cena e ano, a melhor imagem (i.e. com a menor cobertura de nuvens) adquirida no per\u00edodo de junho \u00e0 setembro. gml_exclude_items the_geom gml_include_items all gml_geometries the_geom END PROJECTION init=epsg:4674 END STATUS ON TYPE Raster TEMPLATE DUMMY OFFSITE 0 0 0 PROCESSING SCALE_1=748,1405 PROCESSING SCALE_2=613,1534 PROCESSING SCALE_3=385,2134 PROCESSING BANDS=3,2,1 END \u00c9 importante ressaltar a inser\u00e7\u00e3o do par\u00e2metro PROCESSING \"SCALE_\" ao Mapfile permitindo informar ao Mapserver os valores de bandas definidos anteriormente.","title":"Disponibiliza\u00e7\u00e3o no OWS Server"},{"location":"03-dad_vetoriais/","text":"Dados Vetoriais No Cerrado DPAT todos os dados vetoriais est\u00e3o armazenados em um banco de dados PostgreSQL. O \u00faltimo backup deste banco pode ser encontrado no link no arquivo BKP_BANCO_DADOS_FIP_CERRADO.tar.gz . Banco de dados e MER No modelo de entidade relacionamento (MER) do banco de dados, apresentado a seguir, as tabelas foram agrupadas em duas categorias: Entidades Principais (cinza) : estrutura respons\u00e1vel por armazenar os dados consolidados utilizados no Cerado DPAT, conforme foram disponibilizados pela sua institui\u00e7\u00e3o. O Cerrado DPAT conta com mais de 20 entidades, por\u00e9m, em sua maioria s\u00e3o utilizados apenas como camadas de dados, sem realiza\u00e7\u00e3o de cruzamentos, portanto, as entidades utilizadas neste MER foram as utilizadas em diversos cruzamentos espaciais para an\u00e1lise. Tabelas com cruzamentos espaciais : estrutura respons\u00e1vel por armazenar resultados de cruzamentos espaciais entre diferentes entidades do Cerrado DPAT. Em sua maioria, os cruzamentos espaciais resultam em refer\u00eancias entre chaves \u00fanicas, al\u00e9m do resultado de algum tipo de processamento, como por exemplo, area_desmat , que representa a \u00e1rea desmatada (detectada pelo PRODES-Cerrado) em uma propriedade rural, que \u00e9 armazenada pela tabela car_desmat . Principais entidades prodes_cerrado e deter_cerrado Entidades (tabelas) respons\u00e1veis por armazenar os pol\u00edgonos PRODES-Cerrado e DETER-Cerrado consolidados que s\u00e3o apresentados no Cerrado DPAT. O identificador \u00fanico (gid) destas tabelas s\u00e3o usadas em entidades auxiliares, tais como, pontos_campo , validacao_amostral , car_desmat e outras para identificar seu cruzamento com as mesmas, portanto, n\u00e3o se deve alter\u00e1-lo. regions Entidade respons\u00e1vel por armazenar todas as regi\u00f5es (munic\u00edpios e estados) do Cerrado. A coluna value apresenta o valor de identifica\u00e7\u00e3o da regi\u00e3o e type diferencia munic\u00edpios (anotado como city ) dos estados (anotado como state ). car_cerrado Entidade respons\u00e1vel por armazenar os dados de cada propriedade rural presente no Cerrado. Cada propriedade possui um identificador \u00fanico anotado pela vari\u00e1vel idt_imovel . Este valor \u00e9 utilizado para associar cada propriedade rural com a reserva legal (tabela geo_car_reserva_legal_cerrado ), com \u00e1reas de preserva\u00e7\u00e3o permanente (tabela geo_car_app_cerrado ) e nascentes (tabela geo_car_nascente_cerrado ). Processo de atualiza\u00e7\u00e3o Diversos dados presentes na plataforma Cerrado DPAT s\u00e3o periodicamente atualizados pelas institui\u00e7\u00f5es competentes. Desta forma, a medida que os mesmos s\u00e3o atualizados e disponibilizados pelas institui\u00e7\u00f5es tamb\u00e9m \u00e9 necess\u00e1rio realizar a atualiza\u00e7\u00e3o no banco de dados do Cerrado DPAT. Os comandos a seguir foram todos desenvolvidos na linguagem sql , portanto podem ser executados em qualquer ambiente que realize a conex\u00e3o com PostgreSQL, tais como o pgAdmin ou o pr\u00f3prio ambiente nativo conhecido como psql . A fim de facilitar, pode-se criar um arquivo de extens\u00e3o .sql e execut\u00e1-lo da seguinte forma: psql dbname=' db_name ' user=' db_user ' password=' db_pwd ' host=' db_host' -f path_to_ /yourFileName.sql PRODES Cerrado Devido a divulga\u00e7\u00e3o anual do PRODES-Cerrado \u00e9 necess\u00e1rio realizar a sua atualiza\u00e7\u00e3o sempre que um novo produto \u00e9 lan\u00e7ado. Desta forma, deve-se visitar o site do Terrabrasilis para verificar se um novo PRODES-Cerrado foi lan\u00e7ado e realizar o seu download em Shapefile. A fim de demonstrar todos os procedimentos necess\u00e1rios ap\u00f3s uma nova atualiza\u00e7\u00e3o do PRODES-Cerrado, iremos utilizar o mesmo processo realizado na atualiza\u00e7\u00e3o do PRODES-Cerrado 2019 executada em Janeiro de 2020. Na ocasi\u00e3o o INPE disponibilizou um Shapefile \u00fanico para o PRODES-Cerrado 2019 com uma estrutura pr\u00f3pria detalhada a seguir. Atualmente, pode-se encontrar todos os desmatamentos PRODES-Cerrado em um Shapefile \u00fanico no link . Por\u00e9m \u00e9 importante ressaltar que o padr\u00e3o das colunas disponibilizados pelo INPE pode ser alterada em atualiza\u00e7\u00f5es futuras. Ap\u00f3s download do shapefile \u00fanico contendo os desmatamentos PRODES-Cerrado 2019, primeiramente \u00e9 necess\u00e1rio importar os dados para o banco de dados, alterando corretamente os par\u00e2metros abaixo: shp2pgsql -s 4674 -W UTF-8 ProdesCerrado_2019_incremento.shp public.prodes2019 | psql -h host_address -U db_user -d db_name O comando acima importa os dados do Shapefile em uma tabela nomeada prodes2019 . Na ocasi\u00e3o, o PRODES-Cerrado 2019 foi disponibilizado sem o campo de identifica\u00e7\u00e3o em qual munic\u00edpio aquele desmatamento ocorreu e com a coluna state que identificava os estados pelo nome por extenso. Portanto, inicialmente deve-se alterar o padr\u00e3o dos estados para utilizar o campo uf com apenas 2 caracteres. ALTER TABLE prodes2019 ADD COLUMN uf character varying(2); Em seguida, preencha o campo uf com o seguinte comando: update prodes2019 set uf = CASE when state = 'PAR\u00c1' THEN 'PA' when state = 'MATO GROSSO' THEN 'MT' WHEN state = 'PIAU\u00cd' THEN 'PI' WHEN state = 'BAHIA' THEN 'BA' WHEN state = 'MARANH\u00c3O' THEN 'MA' WHEN state = 'TOCANTINS' THEN 'TO' WHEN state = 'MATO GROSSO DO SUL' THEN 'MS' WHEN state = 'MINAS GERAIS' THEN 'MG' WHEN state = 'PARAN\u00c1' THEN 'PR' WHEN state = 'ROND\u00d4NIA' THEN 'RO' WHEN state = 'S\u00c3O PAULO' THEN 'SP' WHEN state = 'DISTRITO FEDERAL' THEN 'DF' WHEN state = 'GOI\u00c1S' THEN 'GO' ELSE '00' END Al\u00e9m dos estados, caso as novas atualiza\u00e7\u00f5es n\u00e3o possuam a identifica\u00e7\u00e3o do munic\u00edpio, deve-se verificar se o mesmo pol\u00edgono de desmatamento se encontra em mais de um munic\u00edpio ao mesmo tempo, o que pode ser alcan\u00e7ado com a query abaixo. Vale ressaltar que os passos descritos abaixo s\u00f3 devem ser executados caso o INPE n\u00e3o identifique o munic\u00edpio onde ocorreu o desmatamento. SELECT prodes.gid, count(city.*) FROM prodes2019 prodes inner join municipios_cerrado city on ST_INTERSECTS(city.geom, prodes.geom) GROUP BY prodes.gid HAVING COUNT(city.*) 1 Em seguida, deve-se copiar os pol\u00edgonos PRODES-Cerrado 2019 para uma tabela alternativa prodes2019_alt (que possui o campo de munic\u00edpio) dividindo o pol\u00edgono nas por\u00e7\u00f5es que pertencem a cada munic\u00edpio. Esta opera\u00e7\u00e3o ir\u00e1 aumentar a quantidade de pol\u00edgonos no banco, por\u00e9m n\u00e3o ir\u00e1 impactar na \u00e1rea desmatada. ALTER TABLE prodes2019 ADD COLUMN county character varying(60); insert into prodes2019_alt (id, state, path_row, class_name, image_date, year, area_km2, uf, county, geom) select prodes.id, prodes.state, prodes.path_row, prodes.class_name, prodes.image_date, prodes.year, prodes.area_m2, prodes.uf, city.nm_municip, ST_Multi(ST_INTERSECTION(prodes.geom, city.geom)) from prodes2019 prodes inner join municipios_cerrado city on ST_INTERSECTS(prodes.geom, city.geom) Al\u00e9m de criar o campo county , deve-se tamb\u00e9m j\u00e1 armazenar o valor da \u00e1rea do desmatamento de cada pol\u00edgono na tabela prodes2019_alt j\u00e1 convertendo para km\u00b2. update prodes2019_alt set area_km2 = ST_AREA(geom::GEOGRAPHY) / 1000000.0 where year = 2019 Por fim, deve-se inserir os pol\u00edgonos PRODES-Cerrado 2019 na tabela oficial onde est\u00e3o todos os pol\u00edgonos, incluindo a longitude e latitude do Centr\u00f3ide do pol\u00edgono. insert into prodes_cerrado (uid, pathrow, view_date, source, areamunkm, uf, geom, year, classname, lat, long) select id, path_row, image_date, 'inpe cerrado' , area_m2, uf, geom, year, class_name, st_y(ST_PointOnSurface(geom)), st_x(ST_PointOnSurface(geom)) from prodes2019_alt DETER Cerrado Devido a constante revis\u00e3o do DETER-Cerrado, onde pol\u00edgonos de desmatamento s\u00e3o reanalisados e validados antes de sua consolida\u00e7\u00e3o no PRODES-Cerrado, ao atualizar este produto \u00e9 necess\u00e1rio excluir todos os dados anteriores sobre ele e inserir o novo por completo. Para tal, o primeiro passo \u00e9 excluir os registros na tabela deter_cerrado . ALTER TABLE public . pontos_campo DROP CONSTRAINT pontos_campo_deter_id_fkey ; TRUNCATE TABLE deter_cerrado RESTART IDENTITY; ALTER TABLE public . pontos_campo ADD CONSTRAINT pontos_campo_deter_id_fkey FOREIGN KEY (deter_id) REFERENCES deter_cerrado(gid); Obs. Caso seja necess\u00e1rio desativar e reativar mais restri\u00e7\u00f5es (CONSTRAINTS), utilize a query abaixo para encontrar todas as restri\u00e7\u00f5es presentes no banco e em seguida a query seguinte para descobrir todas as queries de reconstru\u00e7\u00e3o das constraints. /* DROP CONSTRAINTS SCRIPT */ SELECT 'ALTER TABLE '||nspname||' . '||relname||' DROP CONSTRAINT '||conname||' ;' FROM pg_constraint INNER JOIN pg_class ON conrelid=pg_class.oid INNER JOIN pg_namespace ON pg_namespace.oid=pg_class.relnamespace ORDER BY CASE WHEN contype='f' THEN 0 ELSE 1 END,contype,nspname,relname,conname /* RECREATE CONSTRAINTS SCRIPT: */ SELECT 'ALTER TABLE '||nspname||' . '||relname||' ADD CONSTRAINT '||conname||' '|| pg_get_constraintdef(pg_constraint.oid)||';' FROM pg_constraint INNER JOIN pg_class ON conrelid=pg_class.oid INNER JOIN pg_namespace ON pg_namespace.oid=pg_class.relnamespace ORDER BY CASE WHEN contype='f' THEN 0 ELSE 1 END DESC,contype DESC,nspname DESC,relname DESC,conname DESC; Em seguida, deve-se realizar o download do Shapefile com todos os Avisos Deter-Cerrado e em seguida pode-se inserir o shape em uma tabela tempor\u00e1ria no banco de dados, nomeada deter_public , atrav\u00e9s do comando: shp2pgsql -s 4674 -W UTF-8 deter_public.shp public.deter_public | psql -h host_address -U db_user -d db_name Com o shape carregado na tabela deter_public no banco de dados, basta popular a tabela deter_cerrado com o seguinte comando em SQL: insert into deter_cerrado (classname, path_row, view_date, sensor, satellite, areamunkm, county, uf, uc, geom) select classname, path_row, view_date, sensor, satellite, areamunkm, municipali, uf, uc, geom from deter_public Por fim, deve-se tamb\u00e9m atualizar a latitude e longitude do centr\u00f3ide do pol\u00edgono DETER-Cerrado: update deter_cerrado set lat = st_y(ST_PointOnSurface(geom)), long = st_x(ST_PointOnSurface(geom)) where lat is null and long is null; Ap\u00f3s a inser\u00e7\u00e3o dos pontos, deve-se excluir os pol\u00edgonos que j\u00e1 foram antropizados e reconhecido pelo PRODES-Cerrado, utilizando a query abaixo: DELETE FROM deter_cerrado d USING prodes_cerrado p WHERE ST_EQUALS(p.geom, d.geom); Cadastro Ambiental Rural (CAR) Ap\u00f3s a cria\u00e7\u00e3o dos quatro shapefiles com os principais componentes do CAR (Propriedades Rurais, Reserva Legal, \u00c1rea de Preserva\u00e7\u00e3o Permanence e Nascentes) deve-se inserir corretamente estes dados no banco de dados. shp2pgsql -s 4674 -W UTF-8 car.shp public.car_cerrado_temp | psql -h host_address -U db_user -d db_name Cruzamentos espaciais entre os dados PRODES e DETER-Cerrado com o CAR Ap\u00f3s realizar a atualiza\u00e7\u00e3o dos dados PRODES-Cerrado, DETER-Cerrado e do CAR \u00e9 necess\u00e1rio realizar os cruzamentos espaciais entre estes dados. Portanto, primeiramente \u00e9 importante apagar os registros anteriores. Inicialmente iremos apagar a tabela de relacionamento entre os dados do CAR e os pol\u00edgonos PRODES e DETER-Cerrado. TRUNCATE TABLE car_desmat RESTART IDENTITY; Em seguida, inicialmente deve-se inserir (em rela\u00e7\u00e3o de 1:1) o cruzamento entre as propriedades do CAR e os pol\u00edgonos PRODES-Cerrado na tabela car_desmat : insert into car_desmat (car_cerrado_id, idt_imovel, prodes_id) select car.gid, car.idt_imovel, prodes.gid from car_cerrado car inner join prodes_cerrado prodes on ST_INTERSECTS(car.geom, prodes.geom) where prodes.year = 2013 Ap\u00f3s o PRODES-Cerrado, insere-se os cruzamentos com o DETER-Cerrado: insert into car_desmat (car_cerrado_id, idt_imovel, deter_id) select car.gid, car.idt_imovel, prodes.gid from car_cerrado car inner join deter_cerrado deter on ST_INTERSECTS(car.geom, deter.geom) Com as rela\u00e7\u00f5es criadas, atualiza-se a tabela car_desmat com a quantidade de nascentes e cada desmatamento detectado dentro de uma propriedade rural: update car_desmat set qnt_nascente = sub.qnt from ( select c.car_cerrado_id as internocar, c.prodes_id as internoprodes, count(rl.gid) as qnt from geo_car_nascente_cerrado rl inner join car_desmat c on c.idt_imovel = rl.idt_imovel group by 1,2 ) as sub where sub.internocar = car_desmat.car_cerrado_id and sub.internoprodes = car_desmat.prodes_id PRODES-Cerrado com os pontos da Valida\u00e7\u00e3o de Campo Ap\u00f3s atualiza\u00e7\u00e3o dos dado PRODES-Cerrado, \u00e9 necess\u00e1ria a atualiza\u00e7\u00e3o da refer\u00eancia ao pol\u00edgono PRODES-Cerrado em rela\u00e7\u00e3o aos pontos visitados durante a valida\u00e7\u00e3o de campo. Para tal, executasse a seguinte query: UPDATE pontos_campo set prodes_id = p.gid from prodes_cerrado p where pontos_campo.prodes_id is null and ST_INTERSECTS(p.geom, pontos_campo.geom) Em seguida, realiza-se o mesmo processo em rela\u00e7\u00e3o aos pol\u00edgonos DETER-Cerrado: UPDATE pontos_campo set deter_id = d.gid from deter_cerrado d where pontos_campo.deter_id is null and ST_INTERSECTS(d.geom, pontos_campo.geom) PRODES-Cerrado com os pontos da Valida\u00e7\u00e3o Amostral Ap\u00f3s atualiza\u00e7\u00e3o dos dado PRODES-Cerrado, \u00e9 necess\u00e1ria a atualiza\u00e7\u00e3o da refer\u00eancia ao pol\u00edgono PRODES-Cerrado em rela\u00e7\u00e3o aos pontos inspecionados durante a valida\u00e7\u00e3o amostral. Para tal, executasse a seguinte query: UPDATE validacao_amostral set prodes_id = p.gid from prodes_cerrado p where validacao_amostral.prodes_id is null and ST_INTERSECTS(p.geom, validacao_amostral.geom) PRODES-Cerrado acumulado em todas regi\u00f5es (Munic\u00edpios e Estados) Ap\u00f3s a atualiza\u00e7\u00e3o do PRODES-Cerrado, tamb\u00e9m \u00e9 necess\u00e1rio o c\u00e1lculo do desmatamento acumulado por munic\u00edpio e tamb\u00e9m por estado. Para tal, deve-se inicialmente popular a tabela prodes_regions que ir\u00e1 armazenar o id da regi\u00e3o (munic\u00edpio ou estado) e a sua \u00e1rea desmatada. Note que deve-se atualizar a refer\u00eacia where p.year = 2019 para o ano do desmatamento inserido no banco. Portanto, pode-se utilizar a seguinte query: /* Inserir desmatamento acumulado por estado */ insert into prodes_regions (region_id, sum_area_prodes, year) select r.gid, sum(p.areamunkm), p.year from regions r inner join prodes_cerrado p on p.uf = r.value where p.year = 2019 and r.type = 'state' group by 1, 3 /* Inserir desmatamento acumulado por munic\u00edpio */ insert into prodes_regions (region_id, sum_area_prodes, year) select r.gid, sum(p.areamunkm), p.year from regions r inner join prodes_cerrado p on p.cd_geocmu = r.cd_geocmu where p.year = 2019 and r.type = 'city' group by 1, 3 Em seguida, deve-se atualizar os elementos rec\u00e9m inseridos na tabela prodes_regions com a \u00e1rea desmatada dentro de APPs e Reservas Legais: /* Atualiza\u00e7\u00e3o para desmatameto acumulado em APP e RL por estado */ /* APP */ update prodes_regions set area_app = internal.area_desmat from (SELECT sum(st_area(safe_intersection(p.geom, lc.geom)::geography) / 1000000.0::double precision) as area_desmat, r.gid as internoregion, p.year as internoyear from prodes_cerrado p inner join geo_car_app_cerrado lc on lc.uf = p.uf inner join regions r on r.value = lc.uf where ST_INTERSECTS(p.geom, lc.geom) and r.type = 'state' and p.year = 2019 group by 2,3) as internal where prodes_regions.region_id = internal.internoregion AND prodes_regions.year = internal.internoyear and internal.internoyear = 2019 /* RL */ update prodes_regions set area_rl = internal.area_desmat from (SELECT sum(st_area(safe_intersection(p.geom, lc.geom)::geography) / 1000000.0::double precision) as area_desmat, r.gid as internoregion, p.year as internoyear from prodes_cerrado p inner join geo_car_reserva_legal_cerrado lc on lc.uf = p.uf inner join regions r on r.value = lc.uf where ST_INTERSECTS(p.geom, lc.geom) and r.type = 'state' and p.year = 2019 group by 2,3) as internal where prodes_regions.region_id = internal.internoregion AND prodes_regions.year = internal.internoyear and internal.internoyear = 2019 /* Atualiza\u00e7\u00e3o para desmatameto acumulado em APP e RL por munic\u00edpio */ /* APP */ update prodes_regions set area_app = internal.area_desmat from (SELECT sum(st_area(safe_intersection(p.geom, lc.geom)::geography) / 1000000.0::double precision) as area_desmat, r.gid as internoregion, p.year as internoyear from prodes_cerrado p inner join geo_car_app_cerrado lc on lc.cd_geocmu = p.cd_geocmu inner join regions r on r.cd_geocmu = lc.cd_geocmu where ST_INTERSECTS(p.geom, lc.geom) and r.type = 'city' and p.year = 2019 group by 2,3) as internal where prodes_regions.region_id = internal.internoregion AND prodes_regions.year = internal.internoyear and internal.internoyear = 2019 /* RL */ update prodes_regions set area_rl = internal.area_desmat from (SELECT sum(st_area(safe_intersection(p.geom, lc.geom)::geography) / 1000000.0::double precision) as area_desmat, r.gid as internoregion, p.year as internoyear from prodes_cerrado p inner join geo_car_reserva_legal_cerrado lc on lc.cd_geocmu = p.cd_geocmu inner join regions r on r.cd_geocmu = lc.cd_geocmu where ST_INTERSECTS(p.geom, lc.geom) and r.type = 'city' and p.year = 2019 group by 2,3) as internal where prodes_regions.region_id = internal.internoregion AND prodes_regions.year = internal.internoyear and internal.internoyear = 2019 PRODES-Cerrado com todas regi\u00f5es (Munic\u00edpios e Estados) em rela\u00e7\u00e3o ao uso do solo Ap\u00f3s atualiza\u00e7\u00e3o do PRODES-Cerrado, tamb\u00e9m \u00e9 necess\u00e1rio o c\u00e1lculo da propor\u00e7\u00e3o de desmatamento em cada tipo de uso do solo para os pol\u00edgonos rec\u00e9m inseridos no banco de dados. Desta forma, para calcular e inserir no banco esta informa\u00e7\u00e3o para estados e munic\u00edpios respectivamente deve-se executar as seguintes queries. Ap\u00f3s as queries de inser\u00e7\u00e3o dos dados, \u00e9 necess\u00e1rio ajustar a coluna total_area_classe_lulc da tabela prodes_regions_lulc , que representa o total da \u00e1rea de cada classe de uso solo dos mapas. Terraclass insert into prodes_regions_lulc (region_id, year, type, classe_lulc, color, desmat_area_classe_lulc, fonte) select r.gid, p.year, 'state', lc.classe, g.color, sum(st_area(safe_intersection(p.geom, lc.geom)::geography) / 1000000.0::double precision), 'terraclass' from regions r inner join uso_solo_terraclass lc on r.value = lc.uf inner join prodes_cerrado p on r.value = p.uf INNER JOIN graphic_colors g on unaccent(g.name) ilike unaccent(lc.classe) AND g.table_rel = 'uso_solo_terraclass' where r.type = 'state' and ST_INTERSECTS(p.geom, lc.geom) and p.year = 2019 group by 1,2,3,4,5; insert into prodes_regions_lulc (region_id, year, type, classe_lulc, color, desmat_area_classe_lulc, fonte) select r.gid, p.year, 'city', lc.classe, g.color, sum(st_area(safe_intersection(p.geom, lc.geom)::geography) / 1000000.0::double precision), 'terraclass' from regions r inner join uso_solo_probio lc on r.cd_geocmu = lc.cd_geocmu inner join prodes_cerrado p on r.cd_geocmu = p.cd_geocmu INNER JOIN graphic_colors g on unaccent(g.name) ilike unaccent(lc.classe) AND g.table_rel = 'uso_solo_terraclass' where r.type = 'city' and ST_INTERSECTS(p.geom, lc.geom) and p.year 2000 and p.year 2012 group by 1,2,3,4,5; /* Atualiza\u00e7\u00e3o do campo `total_area_classe_lulc` */ /* Por Munic\u00edpio */ update prodes_regions_lulc set total_area_classe_lulc = internal.total_area_lulc from (select r.gid as id, lc.cd_geocmu as code, lc.classe as classeInt, sum(st_area(lc.geom,true)/1000000.0::double precision) as total_area_lulc from uso_solo_terraclass lc inner join regions r on lc.cd_geocmu = r.cd_geocmu where lc.bioma='CERRADO' group by 1,2,3) as internal where prodes_regions_lulc = 'city' and prodes_regions_lulc.region_id = internal.id and prodes_regions_lulc.classe_lulc = internal.classeInt /* Por Estado */ update prodes_regions_lulc set total_area_classe_lulc = internal.total_area_lulc from (select r.gid as id, r.value as code, lc.classe as classeInt, sum(st_area(lc.geom,true)/1000000.0::double precision) as total_area_lulc from uso_solo_terraclass lc inner join regions r on lc.uf = r.value where r.type = 'state' AND lc.bioma='CERRADO' group by 1,2,3) as internal where prodes_regions_lulc = 'state' and prodes_regions_lulc.region_id = internal.id and prodes_regions_lulc.classe_lulc = internal.classeInt PROBIO insert into prodes_regions_lulc (region_id, year, type, classe_lulc, color, desmat_area_classe_lulc, fonte) select r.gid, p.year, 'state', lc.classe, g.color, sum(st_area(safe_intersection(p.geom, lc.geom)::geography) / 1000000.0::double precision), 'probio' from regions r inner join uso_solo_probio lc on r.value = lc.uf inner join prodes_cerrado p on r.value = p.uf INNER JOIN graphic_colors g on unaccent(g.name) ilike unaccent(lc.classe) AND g.table_rel = 'uso_solo_probio' where r.type = 'state' and ST_INTERSECTS(p.geom, lc.geom) and p.year 2000 and p.year 2013 group by 1,2,3,4,5; insert into prodes_regions_lulc (region_id, year, type, classe_lulc, color, desmat_area_classe_lulc, fonte) select r.gid, p.year, 'city', lc.classe, g.color, sum(st_area(safe_intersection(p.geom, lc.geom)::geography) / 1000000.0::double precision), 'probio' from regions r inner join uso_solo_probio lc on r.cd_geocmu = lc.cd_geocmu inner join prodes_cerrado p on r.cd_geocmu = p.cd_geocmu INNER JOIN graphic_colors g on unaccent(g.name) ilike unaccent(lc.classe) AND g.table_rel = 'uso_solo_probio' where r.type = 'city' and ST_INTERSECTS(p.geom, lc.geom) and p.year 2000 and p.year 2012 group by 1,2,3,4,5; /* Atualiza\u00e7\u00e3o do campo `total_area_classe_lulc` */ /* Por Munic\u00edpio */ update prodes_regions_lulc set total_area_classe_lulc = internal.total_area_lulc from (select r.gid as id, lc.cd_geocmu as code, lc.classe as classeInt, sum(st_area(lc.geom,true)/1000000.0::double precision) as total_area_lulc from uso_solo_probio lc inner join regions r on lc.cd_geocmu = r.cd_geocmu where lc.bioma='CERRADO' group by 1,2,3) as internal where prodes_regions_lulc = 'city' and prodes_regions_lulc.region_id = internal.id and prodes_regions_lulc.classe_lulc = internal.classeInt /* Por Estado */ update prodes_regions_lulc set total_area_classe_lulc = internal.total_area_lulc from (select r.gid as id, r.value as code, lc.classe as classeInt, sum(st_area(lc.geom,true)/1000000.0::double precision) as total_area_lulc from uso_solo_probio lc inner join regions r on lc.uf = r.value where r.type = 'state' AND lc.bioma='CERRADO' group by 1,2,3) as internal where prodes_regions_lulc = 'state' and prodes_regions_lulc.region_id = internal.id and prodes_regions_lulc.classe_lulc = internal.classeInt Agrosat\u00e9lite insert into prodes_regions_lulc (region_id, year, type, classe_lulc, color, desmat_area_classe_lulc, fonte) select r.gid, p.year, 'state', lc.classe, g.color, sum(st_area(safe_intersection(p.geom, lc.geom)::geography) / 1000000.0::double precision), 'agrosatelite' from regions r inner join agricultura_agrosatelite lc on r.value = lc.uf inner join prodes_cerrado p on r.value = p.uf INNER JOIN graphic_colors g on unaccent(g.name) ilike unaccent(lc.classe) AND g.table_rel = 'agricultura_agrosatelite' where r.type = 'state' and ST_INTERSECTS(p.geom, lc.geom) and p.year = 2019 group by 1,2,3,4,5; insert into prodes_regions_lulc (region_id, year, type, classe_lulc, color, desmat_area_classe_lulc, fonte) select r.gid, p.year, 'city', lc.classe, g.color, sum(st_area(safe_intersection(p.geom, lc.geom)::geography) / 1000000.0::double precision), 'agrosatelite' from regions r inner join agricultura_agrosatelite lc on r.cd_geocmu = lc.cd_geocmu inner join prodes_cerrado p on r.cd_geocmu = p.cd_geocmu INNER JOIN graphic_colors g on unaccent(g.name) ilike unaccent(lc.classe) AND g.table_rel = 'agricultura_agrosatelite' where r.type = 'city' and ST_INTERSECTS(p.geom, lc.geom) and p.year = 2019 group by 1,2,3,4,5; /* Atualiza\u00e7\u00e3o do campo `total_area_classe_lulc` */ /* Por Munic\u00edpio */ update prodes_regions_lulc set total_area_classe_lulc = internal.total_area_lulc from (select r.gid as id, lc.cd_geocmu as code, lc.classe as classeInt, sum(st_area(lc.geom,true)/1000000.0::double precision) as total_area_lulc from agricultura_agrosatelite lc inner join regions r on lc.cd_geocmu = r.cd_geocmu where lc.bioma='CERRADO' group by 1,2,3) as internal where prodes_regions_lulc = 'city' and prodes_regions_lulc.region_id = internal.id and prodes_regions_lulc.classe_lulc = internal.classeInt /* Por Estado */ update prodes_regions_lulc set total_area_classe_lulc = internal.total_area_lulc from (select r.gid as id, r.value as code, lc.classe as classeInt, sum(st_area(lc.geom,true)/1000000.0::double precision) as total_area_lulc from agricultura_agrosatelite lc inner join regions r on lc.uf = r.value where r.type = 'state' AND lc.bioma='CERRADO' group by 1,2,3) as internal where prodes_regions_lulc = 'state' and prodes_regions_lulc.region_id = internal.id and prodes_regions_lulc.classe_lulc = internal.classeInt","title":"Vetoriais"},{"location":"03-dad_vetoriais/#dados-vetoriais","text":"No Cerrado DPAT todos os dados vetoriais est\u00e3o armazenados em um banco de dados PostgreSQL. O \u00faltimo backup deste banco pode ser encontrado no link no arquivo BKP_BANCO_DADOS_FIP_CERRADO.tar.gz .","title":"Dados Vetoriais"},{"location":"03-dad_vetoriais/#banco-de-dados-e-mer","text":"No modelo de entidade relacionamento (MER) do banco de dados, apresentado a seguir, as tabelas foram agrupadas em duas categorias: Entidades Principais (cinza) : estrutura respons\u00e1vel por armazenar os dados consolidados utilizados no Cerado DPAT, conforme foram disponibilizados pela sua institui\u00e7\u00e3o. O Cerrado DPAT conta com mais de 20 entidades, por\u00e9m, em sua maioria s\u00e3o utilizados apenas como camadas de dados, sem realiza\u00e7\u00e3o de cruzamentos, portanto, as entidades utilizadas neste MER foram as utilizadas em diversos cruzamentos espaciais para an\u00e1lise. Tabelas com cruzamentos espaciais : estrutura respons\u00e1vel por armazenar resultados de cruzamentos espaciais entre diferentes entidades do Cerrado DPAT. Em sua maioria, os cruzamentos espaciais resultam em refer\u00eancias entre chaves \u00fanicas, al\u00e9m do resultado de algum tipo de processamento, como por exemplo, area_desmat , que representa a \u00e1rea desmatada (detectada pelo PRODES-Cerrado) em uma propriedade rural, que \u00e9 armazenada pela tabela car_desmat .","title":"Banco de dados e MER"},{"location":"03-dad_vetoriais/#principais-entidades","text":"","title":"Principais entidades"},{"location":"03-dad_vetoriais/#prodes_cerrado-e-deter_cerrado","text":"Entidades (tabelas) respons\u00e1veis por armazenar os pol\u00edgonos PRODES-Cerrado e DETER-Cerrado consolidados que s\u00e3o apresentados no Cerrado DPAT. O identificador \u00fanico (gid) destas tabelas s\u00e3o usadas em entidades auxiliares, tais como, pontos_campo , validacao_amostral , car_desmat e outras para identificar seu cruzamento com as mesmas, portanto, n\u00e3o se deve alter\u00e1-lo.","title":"prodes_cerrado e deter_cerrado"},{"location":"03-dad_vetoriais/#regions","text":"Entidade respons\u00e1vel por armazenar todas as regi\u00f5es (munic\u00edpios e estados) do Cerrado. A coluna value apresenta o valor de identifica\u00e7\u00e3o da regi\u00e3o e type diferencia munic\u00edpios (anotado como city ) dos estados (anotado como state ).","title":"regions"},{"location":"03-dad_vetoriais/#car_cerrado","text":"Entidade respons\u00e1vel por armazenar os dados de cada propriedade rural presente no Cerrado. Cada propriedade possui um identificador \u00fanico anotado pela vari\u00e1vel idt_imovel . Este valor \u00e9 utilizado para associar cada propriedade rural com a reserva legal (tabela geo_car_reserva_legal_cerrado ), com \u00e1reas de preserva\u00e7\u00e3o permanente (tabela geo_car_app_cerrado ) e nascentes (tabela geo_car_nascente_cerrado ).","title":"car_cerrado"},{"location":"03-dad_vetoriais/#processo-de-atualizacao","text":"Diversos dados presentes na plataforma Cerrado DPAT s\u00e3o periodicamente atualizados pelas institui\u00e7\u00f5es competentes. Desta forma, a medida que os mesmos s\u00e3o atualizados e disponibilizados pelas institui\u00e7\u00f5es tamb\u00e9m \u00e9 necess\u00e1rio realizar a atualiza\u00e7\u00e3o no banco de dados do Cerrado DPAT. Os comandos a seguir foram todos desenvolvidos na linguagem sql , portanto podem ser executados em qualquer ambiente que realize a conex\u00e3o com PostgreSQL, tais como o pgAdmin ou o pr\u00f3prio ambiente nativo conhecido como psql . A fim de facilitar, pode-se criar um arquivo de extens\u00e3o .sql e execut\u00e1-lo da seguinte forma: psql dbname=' db_name ' user=' db_user ' password=' db_pwd ' host=' db_host' -f path_to_ /yourFileName.sql","title":"Processo de atualiza\u00e7\u00e3o"},{"location":"03-dad_vetoriais/#prodes-cerrado","text":"Devido a divulga\u00e7\u00e3o anual do PRODES-Cerrado \u00e9 necess\u00e1rio realizar a sua atualiza\u00e7\u00e3o sempre que um novo produto \u00e9 lan\u00e7ado. Desta forma, deve-se visitar o site do Terrabrasilis para verificar se um novo PRODES-Cerrado foi lan\u00e7ado e realizar o seu download em Shapefile. A fim de demonstrar todos os procedimentos necess\u00e1rios ap\u00f3s uma nova atualiza\u00e7\u00e3o do PRODES-Cerrado, iremos utilizar o mesmo processo realizado na atualiza\u00e7\u00e3o do PRODES-Cerrado 2019 executada em Janeiro de 2020. Na ocasi\u00e3o o INPE disponibilizou um Shapefile \u00fanico para o PRODES-Cerrado 2019 com uma estrutura pr\u00f3pria detalhada a seguir. Atualmente, pode-se encontrar todos os desmatamentos PRODES-Cerrado em um Shapefile \u00fanico no link . Por\u00e9m \u00e9 importante ressaltar que o padr\u00e3o das colunas disponibilizados pelo INPE pode ser alterada em atualiza\u00e7\u00f5es futuras. Ap\u00f3s download do shapefile \u00fanico contendo os desmatamentos PRODES-Cerrado 2019, primeiramente \u00e9 necess\u00e1rio importar os dados para o banco de dados, alterando corretamente os par\u00e2metros abaixo: shp2pgsql -s 4674 -W UTF-8 ProdesCerrado_2019_incremento.shp public.prodes2019 | psql -h host_address -U db_user -d db_name O comando acima importa os dados do Shapefile em uma tabela nomeada prodes2019 . Na ocasi\u00e3o, o PRODES-Cerrado 2019 foi disponibilizado sem o campo de identifica\u00e7\u00e3o em qual munic\u00edpio aquele desmatamento ocorreu e com a coluna state que identificava os estados pelo nome por extenso. Portanto, inicialmente deve-se alterar o padr\u00e3o dos estados para utilizar o campo uf com apenas 2 caracteres. ALTER TABLE prodes2019 ADD COLUMN uf character varying(2); Em seguida, preencha o campo uf com o seguinte comando: update prodes2019 set uf = CASE when state = 'PAR\u00c1' THEN 'PA' when state = 'MATO GROSSO' THEN 'MT' WHEN state = 'PIAU\u00cd' THEN 'PI' WHEN state = 'BAHIA' THEN 'BA' WHEN state = 'MARANH\u00c3O' THEN 'MA' WHEN state = 'TOCANTINS' THEN 'TO' WHEN state = 'MATO GROSSO DO SUL' THEN 'MS' WHEN state = 'MINAS GERAIS' THEN 'MG' WHEN state = 'PARAN\u00c1' THEN 'PR' WHEN state = 'ROND\u00d4NIA' THEN 'RO' WHEN state = 'S\u00c3O PAULO' THEN 'SP' WHEN state = 'DISTRITO FEDERAL' THEN 'DF' WHEN state = 'GOI\u00c1S' THEN 'GO' ELSE '00' END Al\u00e9m dos estados, caso as novas atualiza\u00e7\u00f5es n\u00e3o possuam a identifica\u00e7\u00e3o do munic\u00edpio, deve-se verificar se o mesmo pol\u00edgono de desmatamento se encontra em mais de um munic\u00edpio ao mesmo tempo, o que pode ser alcan\u00e7ado com a query abaixo. Vale ressaltar que os passos descritos abaixo s\u00f3 devem ser executados caso o INPE n\u00e3o identifique o munic\u00edpio onde ocorreu o desmatamento. SELECT prodes.gid, count(city.*) FROM prodes2019 prodes inner join municipios_cerrado city on ST_INTERSECTS(city.geom, prodes.geom) GROUP BY prodes.gid HAVING COUNT(city.*) 1 Em seguida, deve-se copiar os pol\u00edgonos PRODES-Cerrado 2019 para uma tabela alternativa prodes2019_alt (que possui o campo de munic\u00edpio) dividindo o pol\u00edgono nas por\u00e7\u00f5es que pertencem a cada munic\u00edpio. Esta opera\u00e7\u00e3o ir\u00e1 aumentar a quantidade de pol\u00edgonos no banco, por\u00e9m n\u00e3o ir\u00e1 impactar na \u00e1rea desmatada. ALTER TABLE prodes2019 ADD COLUMN county character varying(60); insert into prodes2019_alt (id, state, path_row, class_name, image_date, year, area_km2, uf, county, geom) select prodes.id, prodes.state, prodes.path_row, prodes.class_name, prodes.image_date, prodes.year, prodes.area_m2, prodes.uf, city.nm_municip, ST_Multi(ST_INTERSECTION(prodes.geom, city.geom)) from prodes2019 prodes inner join municipios_cerrado city on ST_INTERSECTS(prodes.geom, city.geom) Al\u00e9m de criar o campo county , deve-se tamb\u00e9m j\u00e1 armazenar o valor da \u00e1rea do desmatamento de cada pol\u00edgono na tabela prodes2019_alt j\u00e1 convertendo para km\u00b2. update prodes2019_alt set area_km2 = ST_AREA(geom::GEOGRAPHY) / 1000000.0 where year = 2019 Por fim, deve-se inserir os pol\u00edgonos PRODES-Cerrado 2019 na tabela oficial onde est\u00e3o todos os pol\u00edgonos, incluindo a longitude e latitude do Centr\u00f3ide do pol\u00edgono. insert into prodes_cerrado (uid, pathrow, view_date, source, areamunkm, uf, geom, year, classname, lat, long) select id, path_row, image_date, 'inpe cerrado' , area_m2, uf, geom, year, class_name, st_y(ST_PointOnSurface(geom)), st_x(ST_PointOnSurface(geom)) from prodes2019_alt","title":"PRODES Cerrado"},{"location":"03-dad_vetoriais/#deter-cerrado","text":"Devido a constante revis\u00e3o do DETER-Cerrado, onde pol\u00edgonos de desmatamento s\u00e3o reanalisados e validados antes de sua consolida\u00e7\u00e3o no PRODES-Cerrado, ao atualizar este produto \u00e9 necess\u00e1rio excluir todos os dados anteriores sobre ele e inserir o novo por completo. Para tal, o primeiro passo \u00e9 excluir os registros na tabela deter_cerrado . ALTER TABLE public . pontos_campo DROP CONSTRAINT pontos_campo_deter_id_fkey ; TRUNCATE TABLE deter_cerrado RESTART IDENTITY; ALTER TABLE public . pontos_campo ADD CONSTRAINT pontos_campo_deter_id_fkey FOREIGN KEY (deter_id) REFERENCES deter_cerrado(gid); Obs. Caso seja necess\u00e1rio desativar e reativar mais restri\u00e7\u00f5es (CONSTRAINTS), utilize a query abaixo para encontrar todas as restri\u00e7\u00f5es presentes no banco e em seguida a query seguinte para descobrir todas as queries de reconstru\u00e7\u00e3o das constraints. /* DROP CONSTRAINTS SCRIPT */ SELECT 'ALTER TABLE '||nspname||' . '||relname||' DROP CONSTRAINT '||conname||' ;' FROM pg_constraint INNER JOIN pg_class ON conrelid=pg_class.oid INNER JOIN pg_namespace ON pg_namespace.oid=pg_class.relnamespace ORDER BY CASE WHEN contype='f' THEN 0 ELSE 1 END,contype,nspname,relname,conname /* RECREATE CONSTRAINTS SCRIPT: */ SELECT 'ALTER TABLE '||nspname||' . '||relname||' ADD CONSTRAINT '||conname||' '|| pg_get_constraintdef(pg_constraint.oid)||';' FROM pg_constraint INNER JOIN pg_class ON conrelid=pg_class.oid INNER JOIN pg_namespace ON pg_namespace.oid=pg_class.relnamespace ORDER BY CASE WHEN contype='f' THEN 0 ELSE 1 END DESC,contype DESC,nspname DESC,relname DESC,conname DESC; Em seguida, deve-se realizar o download do Shapefile com todos os Avisos Deter-Cerrado e em seguida pode-se inserir o shape em uma tabela tempor\u00e1ria no banco de dados, nomeada deter_public , atrav\u00e9s do comando: shp2pgsql -s 4674 -W UTF-8 deter_public.shp public.deter_public | psql -h host_address -U db_user -d db_name Com o shape carregado na tabela deter_public no banco de dados, basta popular a tabela deter_cerrado com o seguinte comando em SQL: insert into deter_cerrado (classname, path_row, view_date, sensor, satellite, areamunkm, county, uf, uc, geom) select classname, path_row, view_date, sensor, satellite, areamunkm, municipali, uf, uc, geom from deter_public Por fim, deve-se tamb\u00e9m atualizar a latitude e longitude do centr\u00f3ide do pol\u00edgono DETER-Cerrado: update deter_cerrado set lat = st_y(ST_PointOnSurface(geom)), long = st_x(ST_PointOnSurface(geom)) where lat is null and long is null; Ap\u00f3s a inser\u00e7\u00e3o dos pontos, deve-se excluir os pol\u00edgonos que j\u00e1 foram antropizados e reconhecido pelo PRODES-Cerrado, utilizando a query abaixo: DELETE FROM deter_cerrado d USING prodes_cerrado p WHERE ST_EQUALS(p.geom, d.geom);","title":"DETER Cerrado"},{"location":"03-dad_vetoriais/#cadastro-ambiental-rural-car","text":"Ap\u00f3s a cria\u00e7\u00e3o dos quatro shapefiles com os principais componentes do CAR (Propriedades Rurais, Reserva Legal, \u00c1rea de Preserva\u00e7\u00e3o Permanence e Nascentes) deve-se inserir corretamente estes dados no banco de dados. shp2pgsql -s 4674 -W UTF-8 car.shp public.car_cerrado_temp | psql -h host_address -U db_user -d db_name","title":"Cadastro Ambiental Rural (CAR)"},{"location":"03-dad_vetoriais/#cruzamentos-espaciais-entre-os-dados","text":"","title":"Cruzamentos espaciais entre os dados"},{"location":"03-dad_vetoriais/#prodes-e-deter-cerrado-com-o-car","text":"Ap\u00f3s realizar a atualiza\u00e7\u00e3o dos dados PRODES-Cerrado, DETER-Cerrado e do CAR \u00e9 necess\u00e1rio realizar os cruzamentos espaciais entre estes dados. Portanto, primeiramente \u00e9 importante apagar os registros anteriores. Inicialmente iremos apagar a tabela de relacionamento entre os dados do CAR e os pol\u00edgonos PRODES e DETER-Cerrado. TRUNCATE TABLE car_desmat RESTART IDENTITY; Em seguida, inicialmente deve-se inserir (em rela\u00e7\u00e3o de 1:1) o cruzamento entre as propriedades do CAR e os pol\u00edgonos PRODES-Cerrado na tabela car_desmat : insert into car_desmat (car_cerrado_id, idt_imovel, prodes_id) select car.gid, car.idt_imovel, prodes.gid from car_cerrado car inner join prodes_cerrado prodes on ST_INTERSECTS(car.geom, prodes.geom) where prodes.year = 2013 Ap\u00f3s o PRODES-Cerrado, insere-se os cruzamentos com o DETER-Cerrado: insert into car_desmat (car_cerrado_id, idt_imovel, deter_id) select car.gid, car.idt_imovel, prodes.gid from car_cerrado car inner join deter_cerrado deter on ST_INTERSECTS(car.geom, deter.geom) Com as rela\u00e7\u00f5es criadas, atualiza-se a tabela car_desmat com a quantidade de nascentes e cada desmatamento detectado dentro de uma propriedade rural: update car_desmat set qnt_nascente = sub.qnt from ( select c.car_cerrado_id as internocar, c.prodes_id as internoprodes, count(rl.gid) as qnt from geo_car_nascente_cerrado rl inner join car_desmat c on c.idt_imovel = rl.idt_imovel group by 1,2 ) as sub where sub.internocar = car_desmat.car_cerrado_id and sub.internoprodes = car_desmat.prodes_id","title":"PRODES e DETER-Cerrado com o CAR"},{"location":"03-dad_vetoriais/#prodes-cerrado-com-os-pontos-da-validacao-de-campo","text":"Ap\u00f3s atualiza\u00e7\u00e3o dos dado PRODES-Cerrado, \u00e9 necess\u00e1ria a atualiza\u00e7\u00e3o da refer\u00eancia ao pol\u00edgono PRODES-Cerrado em rela\u00e7\u00e3o aos pontos visitados durante a valida\u00e7\u00e3o de campo. Para tal, executasse a seguinte query: UPDATE pontos_campo set prodes_id = p.gid from prodes_cerrado p where pontos_campo.prodes_id is null and ST_INTERSECTS(p.geom, pontos_campo.geom) Em seguida, realiza-se o mesmo processo em rela\u00e7\u00e3o aos pol\u00edgonos DETER-Cerrado: UPDATE pontos_campo set deter_id = d.gid from deter_cerrado d where pontos_campo.deter_id is null and ST_INTERSECTS(d.geom, pontos_campo.geom)","title":"PRODES-Cerrado com os pontos da Valida\u00e7\u00e3o de Campo"},{"location":"03-dad_vetoriais/#prodes-cerrado-com-os-pontos-da-validacao-amostral","text":"Ap\u00f3s atualiza\u00e7\u00e3o dos dado PRODES-Cerrado, \u00e9 necess\u00e1ria a atualiza\u00e7\u00e3o da refer\u00eancia ao pol\u00edgono PRODES-Cerrado em rela\u00e7\u00e3o aos pontos inspecionados durante a valida\u00e7\u00e3o amostral. Para tal, executasse a seguinte query: UPDATE validacao_amostral set prodes_id = p.gid from prodes_cerrado p where validacao_amostral.prodes_id is null and ST_INTERSECTS(p.geom, validacao_amostral.geom)","title":"PRODES-Cerrado com os pontos da Valida\u00e7\u00e3o Amostral"},{"location":"03-dad_vetoriais/#prodes-cerrado-acumulado-em-todas-regioes-municipios-e-estados","text":"Ap\u00f3s a atualiza\u00e7\u00e3o do PRODES-Cerrado, tamb\u00e9m \u00e9 necess\u00e1rio o c\u00e1lculo do desmatamento acumulado por munic\u00edpio e tamb\u00e9m por estado. Para tal, deve-se inicialmente popular a tabela prodes_regions que ir\u00e1 armazenar o id da regi\u00e3o (munic\u00edpio ou estado) e a sua \u00e1rea desmatada. Note que deve-se atualizar a refer\u00eacia where p.year = 2019 para o ano do desmatamento inserido no banco. Portanto, pode-se utilizar a seguinte query: /* Inserir desmatamento acumulado por estado */ insert into prodes_regions (region_id, sum_area_prodes, year) select r.gid, sum(p.areamunkm), p.year from regions r inner join prodes_cerrado p on p.uf = r.value where p.year = 2019 and r.type = 'state' group by 1, 3 /* Inserir desmatamento acumulado por munic\u00edpio */ insert into prodes_regions (region_id, sum_area_prodes, year) select r.gid, sum(p.areamunkm), p.year from regions r inner join prodes_cerrado p on p.cd_geocmu = r.cd_geocmu where p.year = 2019 and r.type = 'city' group by 1, 3 Em seguida, deve-se atualizar os elementos rec\u00e9m inseridos na tabela prodes_regions com a \u00e1rea desmatada dentro de APPs e Reservas Legais: /* Atualiza\u00e7\u00e3o para desmatameto acumulado em APP e RL por estado */ /* APP */ update prodes_regions set area_app = internal.area_desmat from (SELECT sum(st_area(safe_intersection(p.geom, lc.geom)::geography) / 1000000.0::double precision) as area_desmat, r.gid as internoregion, p.year as internoyear from prodes_cerrado p inner join geo_car_app_cerrado lc on lc.uf = p.uf inner join regions r on r.value = lc.uf where ST_INTERSECTS(p.geom, lc.geom) and r.type = 'state' and p.year = 2019 group by 2,3) as internal where prodes_regions.region_id = internal.internoregion AND prodes_regions.year = internal.internoyear and internal.internoyear = 2019 /* RL */ update prodes_regions set area_rl = internal.area_desmat from (SELECT sum(st_area(safe_intersection(p.geom, lc.geom)::geography) / 1000000.0::double precision) as area_desmat, r.gid as internoregion, p.year as internoyear from prodes_cerrado p inner join geo_car_reserva_legal_cerrado lc on lc.uf = p.uf inner join regions r on r.value = lc.uf where ST_INTERSECTS(p.geom, lc.geom) and r.type = 'state' and p.year = 2019 group by 2,3) as internal where prodes_regions.region_id = internal.internoregion AND prodes_regions.year = internal.internoyear and internal.internoyear = 2019 /* Atualiza\u00e7\u00e3o para desmatameto acumulado em APP e RL por munic\u00edpio */ /* APP */ update prodes_regions set area_app = internal.area_desmat from (SELECT sum(st_area(safe_intersection(p.geom, lc.geom)::geography) / 1000000.0::double precision) as area_desmat, r.gid as internoregion, p.year as internoyear from prodes_cerrado p inner join geo_car_app_cerrado lc on lc.cd_geocmu = p.cd_geocmu inner join regions r on r.cd_geocmu = lc.cd_geocmu where ST_INTERSECTS(p.geom, lc.geom) and r.type = 'city' and p.year = 2019 group by 2,3) as internal where prodes_regions.region_id = internal.internoregion AND prodes_regions.year = internal.internoyear and internal.internoyear = 2019 /* RL */ update prodes_regions set area_rl = internal.area_desmat from (SELECT sum(st_area(safe_intersection(p.geom, lc.geom)::geography) / 1000000.0::double precision) as area_desmat, r.gid as internoregion, p.year as internoyear from prodes_cerrado p inner join geo_car_reserva_legal_cerrado lc on lc.cd_geocmu = p.cd_geocmu inner join regions r on r.cd_geocmu = lc.cd_geocmu where ST_INTERSECTS(p.geom, lc.geom) and r.type = 'city' and p.year = 2019 group by 2,3) as internal where prodes_regions.region_id = internal.internoregion AND prodes_regions.year = internal.internoyear and internal.internoyear = 2019","title":"PRODES-Cerrado acumulado em todas regi\u00f5es (Munic\u00edpios e Estados)"},{"location":"03-dad_vetoriais/#prodes-cerrado-com-todas-regioes-municipios-e-estados-em-relacao-ao-uso-do-solo","text":"Ap\u00f3s atualiza\u00e7\u00e3o do PRODES-Cerrado, tamb\u00e9m \u00e9 necess\u00e1rio o c\u00e1lculo da propor\u00e7\u00e3o de desmatamento em cada tipo de uso do solo para os pol\u00edgonos rec\u00e9m inseridos no banco de dados. Desta forma, para calcular e inserir no banco esta informa\u00e7\u00e3o para estados e munic\u00edpios respectivamente deve-se executar as seguintes queries. Ap\u00f3s as queries de inser\u00e7\u00e3o dos dados, \u00e9 necess\u00e1rio ajustar a coluna total_area_classe_lulc da tabela prodes_regions_lulc , que representa o total da \u00e1rea de cada classe de uso solo dos mapas. Terraclass insert into prodes_regions_lulc (region_id, year, type, classe_lulc, color, desmat_area_classe_lulc, fonte) select r.gid, p.year, 'state', lc.classe, g.color, sum(st_area(safe_intersection(p.geom, lc.geom)::geography) / 1000000.0::double precision), 'terraclass' from regions r inner join uso_solo_terraclass lc on r.value = lc.uf inner join prodes_cerrado p on r.value = p.uf INNER JOIN graphic_colors g on unaccent(g.name) ilike unaccent(lc.classe) AND g.table_rel = 'uso_solo_terraclass' where r.type = 'state' and ST_INTERSECTS(p.geom, lc.geom) and p.year = 2019 group by 1,2,3,4,5; insert into prodes_regions_lulc (region_id, year, type, classe_lulc, color, desmat_area_classe_lulc, fonte) select r.gid, p.year, 'city', lc.classe, g.color, sum(st_area(safe_intersection(p.geom, lc.geom)::geography) / 1000000.0::double precision), 'terraclass' from regions r inner join uso_solo_probio lc on r.cd_geocmu = lc.cd_geocmu inner join prodes_cerrado p on r.cd_geocmu = p.cd_geocmu INNER JOIN graphic_colors g on unaccent(g.name) ilike unaccent(lc.classe) AND g.table_rel = 'uso_solo_terraclass' where r.type = 'city' and ST_INTERSECTS(p.geom, lc.geom) and p.year 2000 and p.year 2012 group by 1,2,3,4,5; /* Atualiza\u00e7\u00e3o do campo `total_area_classe_lulc` */ /* Por Munic\u00edpio */ update prodes_regions_lulc set total_area_classe_lulc = internal.total_area_lulc from (select r.gid as id, lc.cd_geocmu as code, lc.classe as classeInt, sum(st_area(lc.geom,true)/1000000.0::double precision) as total_area_lulc from uso_solo_terraclass lc inner join regions r on lc.cd_geocmu = r.cd_geocmu where lc.bioma='CERRADO' group by 1,2,3) as internal where prodes_regions_lulc = 'city' and prodes_regions_lulc.region_id = internal.id and prodes_regions_lulc.classe_lulc = internal.classeInt /* Por Estado */ update prodes_regions_lulc set total_area_classe_lulc = internal.total_area_lulc from (select r.gid as id, r.value as code, lc.classe as classeInt, sum(st_area(lc.geom,true)/1000000.0::double precision) as total_area_lulc from uso_solo_terraclass lc inner join regions r on lc.uf = r.value where r.type = 'state' AND lc.bioma='CERRADO' group by 1,2,3) as internal where prodes_regions_lulc = 'state' and prodes_regions_lulc.region_id = internal.id and prodes_regions_lulc.classe_lulc = internal.classeInt PROBIO insert into prodes_regions_lulc (region_id, year, type, classe_lulc, color, desmat_area_classe_lulc, fonte) select r.gid, p.year, 'state', lc.classe, g.color, sum(st_area(safe_intersection(p.geom, lc.geom)::geography) / 1000000.0::double precision), 'probio' from regions r inner join uso_solo_probio lc on r.value = lc.uf inner join prodes_cerrado p on r.value = p.uf INNER JOIN graphic_colors g on unaccent(g.name) ilike unaccent(lc.classe) AND g.table_rel = 'uso_solo_probio' where r.type = 'state' and ST_INTERSECTS(p.geom, lc.geom) and p.year 2000 and p.year 2013 group by 1,2,3,4,5; insert into prodes_regions_lulc (region_id, year, type, classe_lulc, color, desmat_area_classe_lulc, fonte) select r.gid, p.year, 'city', lc.classe, g.color, sum(st_area(safe_intersection(p.geom, lc.geom)::geography) / 1000000.0::double precision), 'probio' from regions r inner join uso_solo_probio lc on r.cd_geocmu = lc.cd_geocmu inner join prodes_cerrado p on r.cd_geocmu = p.cd_geocmu INNER JOIN graphic_colors g on unaccent(g.name) ilike unaccent(lc.classe) AND g.table_rel = 'uso_solo_probio' where r.type = 'city' and ST_INTERSECTS(p.geom, lc.geom) and p.year 2000 and p.year 2012 group by 1,2,3,4,5; /* Atualiza\u00e7\u00e3o do campo `total_area_classe_lulc` */ /* Por Munic\u00edpio */ update prodes_regions_lulc set total_area_classe_lulc = internal.total_area_lulc from (select r.gid as id, lc.cd_geocmu as code, lc.classe as classeInt, sum(st_area(lc.geom,true)/1000000.0::double precision) as total_area_lulc from uso_solo_probio lc inner join regions r on lc.cd_geocmu = r.cd_geocmu where lc.bioma='CERRADO' group by 1,2,3) as internal where prodes_regions_lulc = 'city' and prodes_regions_lulc.region_id = internal.id and prodes_regions_lulc.classe_lulc = internal.classeInt /* Por Estado */ update prodes_regions_lulc set total_area_classe_lulc = internal.total_area_lulc from (select r.gid as id, r.value as code, lc.classe as classeInt, sum(st_area(lc.geom,true)/1000000.0::double precision) as total_area_lulc from uso_solo_probio lc inner join regions r on lc.uf = r.value where r.type = 'state' AND lc.bioma='CERRADO' group by 1,2,3) as internal where prodes_regions_lulc = 'state' and prodes_regions_lulc.region_id = internal.id and prodes_regions_lulc.classe_lulc = internal.classeInt Agrosat\u00e9lite insert into prodes_regions_lulc (region_id, year, type, classe_lulc, color, desmat_area_classe_lulc, fonte) select r.gid, p.year, 'state', lc.classe, g.color, sum(st_area(safe_intersection(p.geom, lc.geom)::geography) / 1000000.0::double precision), 'agrosatelite' from regions r inner join agricultura_agrosatelite lc on r.value = lc.uf inner join prodes_cerrado p on r.value = p.uf INNER JOIN graphic_colors g on unaccent(g.name) ilike unaccent(lc.classe) AND g.table_rel = 'agricultura_agrosatelite' where r.type = 'state' and ST_INTERSECTS(p.geom, lc.geom) and p.year = 2019 group by 1,2,3,4,5; insert into prodes_regions_lulc (region_id, year, type, classe_lulc, color, desmat_area_classe_lulc, fonte) select r.gid, p.year, 'city', lc.classe, g.color, sum(st_area(safe_intersection(p.geom, lc.geom)::geography) / 1000000.0::double precision), 'agrosatelite' from regions r inner join agricultura_agrosatelite lc on r.cd_geocmu = lc.cd_geocmu inner join prodes_cerrado p on r.cd_geocmu = p.cd_geocmu INNER JOIN graphic_colors g on unaccent(g.name) ilike unaccent(lc.classe) AND g.table_rel = 'agricultura_agrosatelite' where r.type = 'city' and ST_INTERSECTS(p.geom, lc.geom) and p.year = 2019 group by 1,2,3,4,5; /* Atualiza\u00e7\u00e3o do campo `total_area_classe_lulc` */ /* Por Munic\u00edpio */ update prodes_regions_lulc set total_area_classe_lulc = internal.total_area_lulc from (select r.gid as id, lc.cd_geocmu as code, lc.classe as classeInt, sum(st_area(lc.geom,true)/1000000.0::double precision) as total_area_lulc from agricultura_agrosatelite lc inner join regions r on lc.cd_geocmu = r.cd_geocmu where lc.bioma='CERRADO' group by 1,2,3) as internal where prodes_regions_lulc = 'city' and prodes_regions_lulc.region_id = internal.id and prodes_regions_lulc.classe_lulc = internal.classeInt /* Por Estado */ update prodes_regions_lulc set total_area_classe_lulc = internal.total_area_lulc from (select r.gid as id, r.value as code, lc.classe as classeInt, sum(st_area(lc.geom,true)/1000000.0::double precision) as total_area_lulc from agricultura_agrosatelite lc inner join regions r on lc.uf = r.value where r.type = 'state' AND lc.bioma='CERRADO' group by 1,2,3) as internal where prodes_regions_lulc = 'state' and prodes_regions_lulc.region_id = internal.id and prodes_regions_lulc.classe_lulc = internal.classeInt","title":"PRODES-Cerrado com todas regi\u00f5es (Munic\u00edpios e Estados) em rela\u00e7\u00e3o ao uso do solo"}]}